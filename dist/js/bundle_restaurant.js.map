{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/dbhelper.js","src/js/images.js","src/js/restaurant_info.js"],"names":[],"mappings":"AAAA;ACAA,MAAM,YAAY,QAAQ,UAAR,CAAlB;AACA;;;AAGA,MAAM,QAAN,CAAe;;AAEb;;;;AAIA,aAAW,YAAX,GAA0B;AACxB,UAAM,OAAO,eAAb,CADwB,CACK;AAC7B,WAAQ,oBAAmB,IAAK,cAAhC;AACD;;AAED;;;AAGA,SAAO,gBAAP,CAAwB,QAAxB,EAAkC;AAChC,QAAI,MAAM,IAAI,cAAJ,EAAV;AACA,QAAI,IAAJ,CAAS,KAAT,EAAgB,SAAS,YAAzB;AACA,QAAI,MAAJ,GAAa,MAAM;AACjB,UAAI,IAAI,MAAJ,KAAe,GAAnB,EAAwB;AAAE;AACxB,cAAM,cAAc,KAAK,KAAL,CAAW,IAAI,YAAf,CAApB;AACA,cAAM,YAAY,UAAU,aAA5B;AACA,oBAAY,GAAZ,CAAgB,UAAU,UAAV,EAAsB;AACpC,cAAI,WAAW,UAAf,EAA2B;AACzB,uBAAW,GAAX,GAAiB,UAAU,WAAW,UAArB,EAAiC,GAAlD;AACA,uBAAW,OAAX,GAAqB,UAAU,WAAW,UAArB,EAAiC,OAAtD;AACD;AACD,iBAAO,UAAP;AACD,SAND;AAOA,iBAAS,IAAT,EAAe,WAAf;AACD,OAXD,MAWO;AAAE;AACP,cAAM,QAAU,sCAAqC,IAAI,MAAO,EAAhE;AACA,iBAAS,KAAT,EAAgB,IAAhB;AACD;AACF,KAhBD;AAiBA,QAAI,IAAJ;AACD;;AAED;;;AAGA,SAAO,mBAAP,CAA2B,EAA3B,EAA+B,QAA/B,EAAyC;AACvC,QAAI,MAAM,IAAI,cAAJ,EAAV;AACA,QAAI,IAAJ,CAAS,KAAT,EAAgB,SAAS,YAAT,GAAwB,GAAxB,GAA8B,EAA9C;AACA,QAAI,MAAJ,GAAa,MAAM;AACjB,UAAI,IAAI,MAAJ,KAAe,GAAnB,EAAwB;AAAE;AACxB,cAAM,aAAa,KAAK,KAAL,CAAW,IAAI,YAAf,CAAnB;AACA,YAAI,WAAW,UAAf,EAA2B;AACzB,gBAAM,YAAY,UAAU,aAA5B;AACA,qBAAW,GAAX,GAAiB,UAAU,WAAW,UAArB,EAAiC,GAAlD;AACA,qBAAW,OAAX,GAAqB,UAAU,WAAW,UAArB,EAAiC,OAAtD;AACD;AACD,iBAAS,IAAT,EAAe,UAAf;AACD,OARD,MAQO;AAAE;AACP,cAAM,QAAU,sCAAqC,IAAI,MAAO,EAAhE;AACA,iBAAS,KAAT,EAAgB,IAAhB;AACD;AACF,KAbD;AAcA,QAAI,IAAJ;AACD;;AAED;;;AAGA,SAAO,wBAAP,CAAgC,OAAhC,EAAyC,QAAzC,EAAmD;AACjD;AACA,aAAS,gBAAT,CAA0B,CAAC,KAAD,EAAQ,WAAR,KAAwB;AAChD,UAAI,KAAJ,EAAW;AACT,iBAAS,KAAT,EAAgB,IAAhB;AACD,OAFD,MAEO;AACL;AACA,cAAM,UAAU,YAAY,MAAZ,CAAmB,KAAK,EAAE,YAAF,IAAkB,OAA1C,CAAhB;AACA,iBAAS,IAAT,EAAe,OAAf;AACD;AACF,KARD;AASD;;AAED;;;AAGA,SAAO,6BAAP,CAAqC,YAArC,EAAmD,QAAnD,EAA6D;AAC3D;AACA,aAAS,gBAAT,CAA0B,CAAC,KAAD,EAAQ,WAAR,KAAwB;AAChD,UAAI,KAAJ,EAAW;AACT,iBAAS,KAAT,EAAgB,IAAhB;AACD,OAFD,MAEO;AACL;AACA,cAAM,UAAU,YAAY,MAAZ,CAAmB,KAAK,EAAE,YAAF,IAAkB,YAA1C,CAAhB;AACA,iBAAS,IAAT,EAAe,OAAf;AACD;AACF,KARD;AASD;;AAED;;;AAGA,SAAO,uCAAP,CAA+C,OAA/C,EAAwD,YAAxD,EAAsE,QAAtE,EAAgF;AAC9E;AACA,aAAS,gBAAT,CAA0B,CAAC,KAAD,EAAQ,WAAR,KAAwB;AAChD,UAAI,KAAJ,EAAW;AACT,iBAAS,KAAT,EAAgB,IAAhB;AACD,OAFD,MAEO;AACL,YAAI,UAAU,WAAd;AACA,YAAI,WAAW,KAAf,EAAsB;AAAE;AACtB,oBAAU,QAAQ,MAAR,CAAe,KAAK,EAAE,YAAF,IAAkB,OAAtC,CAAV;AACD;AACD,YAAI,gBAAgB,KAApB,EAA2B;AAAE;AAC3B,oBAAU,QAAQ,MAAR,CAAe,KAAK,EAAE,YAAF,IAAkB,YAAtC,CAAV;AACD;AACD,iBAAS,IAAT,EAAe,OAAf;AACD;AACF,KAbD;AAcD;;AAED;;;AAGA,SAAO,kBAAP,CAA0B,QAA1B,EAAoC;AAClC;AACA,aAAS,gBAAT,CAA0B,CAAC,KAAD,EAAQ,WAAR,KAAwB;AAChD,UAAI,KAAJ,EAAW;AACT,iBAAS,KAAT,EAAgB,IAAhB;AACD,OAFD,MAEO;AACL;AACA,cAAM,gBAAgB,YAAY,GAAZ,CAAgB,CAAC,CAAD,EAAI,CAAJ,KAAU,YAAY,CAAZ,EAAe,YAAzC,CAAtB;AACA;AACA,cAAM,sBAAsB,cAAc,MAAd,CAAqB,CAAC,CAAD,EAAI,CAAJ,KAAU,cAAc,OAAd,CAAsB,CAAtB,KAA4B,CAA3D,CAA5B;AACA,iBAAS,IAAT,EAAe,mBAAf;AACD;AACF,KAVD;AAWD;;AAED;;;AAGA,SAAO,aAAP,CAAqB,QAArB,EAA+B;AAC7B;AACA,aAAS,gBAAT,CAA0B,CAAC,KAAD,EAAQ,WAAR,KAAwB;AAChD,UAAI,KAAJ,EAAW;AACT,iBAAS,KAAT,EAAgB,IAAhB;AACD,OAFD,MAEO;AACL;AACA,cAAM,WAAW,YAAY,GAAZ,CAAgB,CAAC,CAAD,EAAI,CAAJ,KAAU,YAAY,CAAZ,EAAe,YAAzC,CAAjB;AACA;AACA,cAAM,iBAAiB,SAAS,MAAT,CAAgB,CAAC,CAAD,EAAI,CAAJ,KAAU,SAAS,OAAT,CAAiB,CAAjB,KAAuB,CAAjD,CAAvB;AACA,iBAAS,IAAT,EAAe,cAAf;AACD;AACF,KAVD;AAWD;;AAED;;;AAGA,SAAO,gBAAP,CAAwB,UAAxB,EAAoC;AAClC,WAAS,wBAAuB,WAAW,EAAG,EAA9C;AACD;;AAED;;;AAGA,SAAO,qBAAP,CAA6B,UAA7B,EAAyC;AACvC,UAAM,sBAAsB,SAAS,yBAAT,CAAmC,WAAW,UAA9C,CAA5B;AACA,WAAO,mBAAP;AACD;;AAED;;;AAGA,SAAO,yBAAP,CAAiC,QAAjC,EAA2C;AACzC,UAAM,CAAC,UAAD,EAAa,MAAb,IAAuB,CAAC,QAAD,EAAW,KAAX,CAA7B;AACA,UAAM,WAAW,WAAW,MAAX,CAAkB,QAAlB,EAA4B,UAA5B,EAAwC,GAAxC,EAA6C,MAA7C,CAAjB;AACA,UAAM,WAAW,WAAW,MAAX,CAAkB,QAAlB,EAA4B,UAA5B,EAAwC,GAAxC,EAA6C,MAA7C,CAAjB;AACA,UAAM,WAAW,WAAW,MAAX,CAAkB,QAAlB,EAA4B,SAA5B,EAAuC,GAAvC,EAA4C,MAA5C,CAAjB;AACA,UAAM,WAAW,WAAW,MAAX,CAAkB,QAAlB,EAA4B,SAA5B,EAAuC,GAAvC,EAA4C,MAA5C,CAAjB;;AAEA,WAAO;AACL,gBAAU,QADL;AAEL,gBAAU,QAFL;AAGL,gBAAU,QAHL;AAIL,gBAAU;AAJL,KAAP;AAMD;;AAED;;;AAGA,SAAO,sBAAP,CAA8B,UAA9B,EAA0C,GAA1C,EAA+C;AAC7C,UAAM,SAAS,IAAI,OAAO,IAAP,CAAY,MAAhB,CAAuB;AACpC,gBAAU,WAAW,MADe;AAEpC,aAAO,WAAW,IAFkB;AAGpC,WAAK,SAAS,gBAAT,CAA0B,UAA1B,CAH+B;AAIpC,WAAK,GAJ+B;AAKpC,iBAAW,OAAO,IAAP,CAAY,SAAZ,CAAsB;AALG,KAAvB,CAAf;AAOA,WAAO,MAAP;AACD;;AAlMY;AAqMf,OAAO,OAAP,GAAiB,QAAjB;;;ACzMA;;;AAGA,MAAM,SAAN,CAAgB;;AAEd,aAAW,aAAX,GAA2B;;AAEzB,WAAO;AACL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,GAFb;AAGD,eAAO,0BAHN;AAID,mBAAW;AAJV,OADE;AAOL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,GAFb;AAGD,eAAO,kBAHN;AAID,mBAAW;AAJV,OAPE;AAaL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,OAFb;AAGD,eAAO,gCAHN;AAID,mBAAW;AAJV,OAbE;AAmBL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,OAFb;AAGD,eAAO,0BAHN;AAID,mBAAW;AAJV,OAnBE;AAyBL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,OAFb;AAGD,eAAO,sCAHN;AAID,mBAAW;AAJV,OAzBE;AA+BL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,OAFb;AAGD,eAAO,4DAHN;AAID,mBAAW;AAJV,OA/BE;AAqCL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,OAFb;AAGD,eAAO,mEAHN;AAID,mBAAW;AAJV,OArCE;AA2CL,SAAG;AACD,cAAM,CADL;AAED,gBAAQ,WAFP;AAGD,wBAAgB,WAHf;AAID,sBAAc;AAJb,OA3CE;AAiDL,SAAG;AACD,cAAM,CADL;AAED,sBAAc,OAFb;AAGD,mBAAW,8BAHV;AAID,eAAO;AAJN,OAjDE;AAuDL,UAAI;AACF,cAAM,EADJ;AAEF,sBAAc,QAFZ;AAGF,eAAO,iEAHL;AAIF,mBAAW;AAJT;AAvDC,KAAP;AA8DD;AAlEa;;AAqEhB,OAAO,OAAP,GAAiB,SAAjB;;;;;ACxEA,MAAM,WAAW,QAAQ,YAAR,CAAjB;;AAEA,IAAI,UAAJ;AACA,IAAI,GAAJ;;AAEA;;;AAGA,OAAO,OAAP,GAAiB,MAAM;AACrB,yBAAuB,CAAC,KAAD,EAAQ,UAAR,KAAuB;AAC5C,QAAI,KAAJ,EAAW;AAAE;AACX,cAAQ,KAAR,CAAc,KAAd;AACD,KAFD,MAEO;AACL,YAAK,GAAL,GAAW,IAAI,OAAO,IAAP,CAAY,GAAhB,CAAoB,SAAS,cAAT,CAAwB,KAAxB,CAApB,EAAoD;AAC7D,cAAM,EADuD;AAE7D,gBAAQ,WAAW,MAF0C;AAG7D,qBAAa;AAHgD,OAApD,CAAX;AAKA;AACA,eAAS,sBAAT,CAAgC,MAAK,UAArC,EAAiD,MAAK,GAAtD;AACD;AACF,GAZD;AAaD,CAdD;;AAgBA;;;AAGA,yBAA0B,QAAD,IAAc;AACrC,MAAI,MAAK,UAAT,EAAqB;AAAE;AACrB,aAAS,IAAT,EAAe,MAAK,UAApB;AACA;AACD;AACD,QAAM,KAAK,mBAAmB,IAAnB,CAAX;AACA,MAAI,CAAC,EAAL,EAAS;AAAE;AACT,YAAQ,yBAAR;AACA,aAAS,KAAT,EAAgB,IAAhB;AACD,GAHD,MAGO;AACL,aAAS,mBAAT,CAA6B,EAA7B,EAAiC,CAAC,KAAD,EAAQ,UAAR,KAAuB;AACtD,YAAK,UAAL,GAAkB,UAAlB;AACA,UAAI,CAAC,UAAL,EAAiB;AACf,gBAAQ,KAAR,CAAc,KAAd;AACA;AACD;AACD;AACA,eAAS,IAAT,EAAe,UAAf;AACD,KARD;AASD;AACF,CApBD;;AAsBA;;;AAGA,qBAAqB,CAAC,aAAa,MAAK,UAAnB,KAAkC;AACrD,QAAM,OAAO,SAAS,cAAT,CAAwB,iBAAxB,CAAb;AACA,OAAK,SAAL,GAAiB,WAAW,IAA5B;;AAEA,QAAM,UAAU,SAAS,cAAT,CAAwB,oBAAxB,CAAhB;AACA,UAAQ,SAAR,GAAoB,WAAW,OAA/B;;AAEA,MAAI,WAAW,UAAf,EAA2B;AACzB,UAAM,UAAU,SAAS,cAAT,CAAwB,gBAAxB,CAAhB;AACA,YAAQ,SAAR,GAAoB,gBAApB;AACA,YAAQ,YAAR,CAAqB,iBAArB,EAAwC,SAAS,WAAW,EAA5D;AACA,YAAQ,YAAR,CAAqB,MAArB,EAA6B,KAA7B;;AAEA,UAAM,uBAAuB,SAAS,qBAAT,CAA+B,UAA/B,CAA7B;AACA,UAAM,cAAc,SAAS,aAAT,CAAuB,QAAvB,CAApB;AACA,gBAAY,YAAZ,CAAyB,OAAzB,EAAkC,mBAAlC;AACA,gBAAY,YAAZ,CAAyB,QAAzB,EACE,qBAAqB,QAArB,CACC,MADD,CACQ,MADR,EAEC,MAFD,CAEQ,qBAAqB,QAF7B,EAGC,MAHD,CAGQ,KAHR,CADF;AAMA,YAAQ,MAAR,CAAe,WAAf;;AAEA,UAAM,cAAc,SAAS,aAAT,CAAuB,QAAvB,CAApB;AACA,gBAAY,YAAZ,CAAyB,OAAzB,EAAkC,mBAAlC;AACA,gBAAY,YAAZ,CAAyB,QAAzB,EACE,qBAAqB,QAArB,CACC,MADD,CACQ,MADR,EAEC,MAFD,CAEQ,qBAAqB,QAF7B,EAGC,MAHD,CAGQ,KAHR,CADF;AAMA,YAAQ,MAAR,CAAe,WAAf;;AAEA,UAAM,QAAQ,SAAS,aAAT,CAAuB,KAAvB,CAAd;AACA,UAAM,GAAN,GAAY,qBAAqB,QAAjC;AACA,UAAM,YAAN,CAAmB,KAAnB,EAA0B,cAAc,MAAd,CAAqB,WAAW,IAAhC,EAAsC,IAAtC,EAA4C,WAAW,GAAvD,CAA1B;AACA,UAAM,SAAN,GAAkB,gBAAlB;AACA,YAAQ,MAAR,CAAe,KAAf;;AAEA,UAAM,aAAa,SAAS,aAAT,CAAuB,YAAvB,CAAnB;AACA,eAAW,YAAX,CAAwB,IAAxB,EAA8B,SAAS,WAAW,EAAlD;AACA,eAAW,SAAX,GAAuB,WAAW,OAAlC;AACA,YAAQ,MAAR,CAAe,UAAf;AACD;;AAED,QAAM,UAAU,SAAS,cAAT,CAAwB,oBAAxB,CAAhB;AACA,UAAQ,SAAR,GAAoB,WAAW,YAA/B;;AAEA;AACA,MAAI,WAAW,eAAf,EAAgC;AAC9B;AACD;AACD;AACA;AACD,CAvDD;;AAyDA;;;AAGA,0BAA0B,CAAC,iBAAiB,MAAK,UAAL,CAAgB,eAAlC,KAAsD;AAC9E,QAAM,QAAQ,SAAS,cAAT,CAAwB,kBAAxB,CAAd;AACA,OAAK,IAAI,GAAT,IAAgB,cAAhB,EAAgC;AAC9B,UAAM,MAAM,SAAS,aAAT,CAAuB,IAAvB,CAAZ;;AAEA,UAAM,MAAM,SAAS,aAAT,CAAuB,IAAvB,CAAZ;AACA,QAAI,SAAJ,GAAgB,GAAhB;AACA,QAAI,WAAJ,CAAgB,GAAhB;;AAEA,UAAM,OAAO,SAAS,aAAT,CAAuB,IAAvB,CAAb;AACA,SAAK,SAAL,GAAiB,eAAe,GAAf,CAAjB;AACA,QAAI,WAAJ,CAAgB,IAAhB;;AAEA,UAAM,WAAN,CAAkB,GAAlB;AACD;AACF,CAfD;;AAiBA;;;AAGA,kBAAkB,CAAC,UAAU,MAAK,UAAL,CAAgB,OAA3B,KAAuC;AACvD,QAAM,YAAY,SAAS,cAAT,CAAwB,mBAAxB,CAAlB;AACA,QAAM,QAAQ,SAAS,aAAT,CAAuB,IAAvB,CAAd;AACA,QAAM,SAAN,GAAkB,SAAlB;AACA,YAAU,WAAV,CAAsB,KAAtB;;AAEA,MAAI,CAAC,OAAL,EAAc;AACZ,UAAM,YAAY,SAAS,aAAT,CAAuB,GAAvB,CAAlB;AACA,cAAU,SAAV,GAAsB,iBAAtB;AACA,cAAU,WAAV,CAAsB,SAAtB;AACA;AACD;AACD,QAAM,KAAK,SAAS,cAAT,CAAwB,cAAxB,CAAX;AACA,UAAQ,OAAR,CAAgB,UAAU;AACxB,OAAG,WAAH,CAAe,iBAAiB,MAAjB,CAAf;AACD,GAFD;AAGA,YAAU,WAAV,CAAsB,EAAtB;AACD,CAjBD;;AAmBA;;;AAGA,mBAAoB,MAAD,IAAY;AAC7B,QAAM,KAAK,SAAS,aAAT,CAAuB,IAAvB,CAAX;AACA,QAAM,OAAO,SAAS,aAAT,CAAuB,GAAvB,CAAb;AACA,OAAK,SAAL,GAAiB,OAAO,IAAxB;AACA,KAAG,WAAH,CAAe,IAAf;;AAEA,QAAM,OAAO,SAAS,aAAT,CAAuB,GAAvB,CAAb;AACA,OAAK,SAAL,GAAiB,OAAO,IAAxB;AACA,KAAG,WAAH,CAAe,IAAf;;AAEA,QAAM,SAAS,SAAS,aAAT,CAAuB,GAAvB,CAAf;AACA,SAAO,SAAP,GAAoB,WAAU,OAAO,MAAO,EAA5C;AACA,KAAG,WAAH,CAAe,MAAf;;AAEA,QAAM,WAAW,SAAS,aAAT,CAAuB,GAAvB,CAAjB;AACA,WAAS,SAAT,GAAqB,OAAO,QAA5B;AACA,KAAG,WAAH,CAAe,QAAf;;AAEA,SAAO,EAAP;AACD,CAnBD;;AAqBA;;;AAGA,iBAAiB,CAAC,aAAa,MAAK,UAAnB,KAAkC;AACjD,QAAM,aAAa,SAAS,cAAT,CAAwB,YAAxB,CAAnB;AACA,QAAM,KAAK,SAAS,aAAT,CAAuB,IAAvB,CAAX;AACA,QAAM,SAAS,SAAS,aAAT,CAAuB,GAAvB,CAAf;AACA,SAAO,YAAP,CAAoB,MAApB,EAA4B,GAA5B;AACA,SAAO,YAAP,CAAoB,cAApB,EAAoC,MAApC;AACA,SAAO,YAAP,CAAoB,OAApB,EAA6B,cAA7B;AACA,SAAO,SAAP,GAAmB,WAAW,IAA9B;AACA,KAAG,WAAH,CAAe,MAAf;AACA,aAAW,WAAX,CAAuB,EAAvB;AACD,CAVD;;AAYA;;;AAGA,qBAAqB,CAAC,IAAD,EAAO,GAAP,KAAe;AAClC,MAAI,CAAC,GAAL,EACE,MAAM,OAAO,QAAP,CAAgB,IAAtB;AACF,SAAO,KAAK,OAAL,CAAa,SAAb,EAAwB,MAAxB,CAAP;AACA,QAAM,QAAQ,IAAI,MAAJ,CAAY,OAAM,IAAK,mBAAvB,CAAd;AAAA,QACE,UAAU,MAAM,IAAN,CAAW,GAAX,CADZ;AAEA,MAAI,CAAC,OAAL,EACE,OAAO,IAAP;AACF,MAAI,CAAC,QAAQ,CAAR,CAAL,EACE,OAAO,EAAP;AACF,SAAO,mBAAmB,QAAQ,CAAR,EAAW,OAAX,CAAmB,KAAnB,EAA0B,GAA1B,CAAnB,CAAP;AACD,CAXD","file":"bundle_restaurant.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","const ImageInfo = require('./images')\r\n/**\r\n * Common database helper functions.\r\n */\r\nclass DBHelper {\r\n\r\n  /**\r\n   * Database URL.\r\n   * Change this to restaurants.json file location on your server.\r\n   */\r\n  static get DATABASE_URL() {\r\n    const port = '@@server_port' // Change this to your server port\r\n    return `http://localhost:${port}/restaurants`;\r\n  }\r\n\r\n  /**\r\n   * Fetch all restaurants.\r\n   */\r\n  static fetchRestaurants(callback) {\r\n    let xhr = new XMLHttpRequest();\r\n    xhr.open('GET', DBHelper.DATABASE_URL);\r\n    xhr.onload = () => {\r\n      if (xhr.status === 200) { // Got a success response from server!\r\n        const restaurants = JSON.parse(xhr.responseText);\r\n        const imageData = ImageInfo.ImageInfoData;\r\n        restaurants.map(function (restaurant) {\r\n          if (restaurant.photograph) {\r\n            restaurant.alt = imageData[restaurant.photograph].alt;\r\n            restaurant.caption = imageData[restaurant.photograph].caption;\r\n          }\r\n          return restaurant;\r\n        });\r\n        callback(null, restaurants);\r\n      } else { // Oops!. Got an error from server.\r\n        const error = (`Request failed. Returned status of ${xhr.status}`);\r\n        callback(error, null);\r\n      }\r\n    };\r\n    xhr.send();\r\n  }\r\n\r\n  /**\r\n   * Fetch a restaurant by its ID.\r\n   */\r\n  static fetchRestaurantById(id, callback) {\r\n    let xhr = new XMLHttpRequest();\r\n    xhr.open('GET', DBHelper.DATABASE_URL + '/' + id);\r\n    xhr.onload = () => {\r\n      if (xhr.status === 200) { // Got a success response from server!\r\n        const restaurant = JSON.parse(xhr.responseText);\r\n        if (restaurant.photograph) {\r\n          const imageData = ImageInfo.ImageInfoData;\r\n          restaurant.alt = imageData[restaurant.photograph].alt;\r\n          restaurant.caption = imageData[restaurant.photograph].caption;\r\n        }\r\n        callback(null, restaurant);\r\n      } else { // Oops!. Got an error from server.\r\n        const error = (`Request failed. Returned status of ${xhr.status}`);\r\n        callback(error, null);\r\n      }\r\n    };\r\n    xhr.send();\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a cuisine type with proper error handling.\r\n   */\r\n  static fetchRestaurantByCuisine(cuisine, callback) {\r\n    // Fetch all restaurants  with proper error handling\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given cuisine type\r\n        const results = restaurants.filter(r => r.cuisine_type == cuisine);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a neighborhood with proper error handling.\r\n   */\r\n  static fetchRestaurantByNeighborhood(neighborhood, callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given neighborhood\r\n        const results = restaurants.filter(r => r.neighborhood == neighborhood);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n   */\r\n  static fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        let results = restaurants\r\n        if (cuisine != 'all') { // filter by cuisine\r\n          results = results.filter(r => r.cuisine_type == cuisine);\r\n        }\r\n        if (neighborhood != 'all') { // filter by neighborhood\r\n          results = results.filter(r => r.neighborhood == neighborhood);\r\n        }\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch all neighborhoods with proper error handling.\r\n   */\r\n  static fetchNeighborhoods(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all neighborhoods from all restaurants\r\n        const neighborhoods = restaurants.map((v, i) => restaurants[i].neighborhood)\r\n        // Remove duplicates from neighborhoods\r\n        const uniqueNeighborhoods = neighborhoods.filter((v, i) => neighborhoods.indexOf(v) == i)\r\n        callback(null, uniqueNeighborhoods);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch all cuisines with proper error handling.\r\n   */\r\n  static fetchCuisines(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all cuisines from all restaurants\r\n        const cuisines = restaurants.map((v, i) => restaurants[i].cuisine_type)\r\n        // Remove duplicates from cuisines\r\n        const uniqueCuisines = cuisines.filter((v, i) => cuisines.indexOf(v) == i)\r\n        callback(null, uniqueCuisines);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Restaurant page URL.\r\n   */\r\n  static urlForRestaurant(restaurant) {\r\n    return (`./restaurant.html?id=${restaurant.id}`);\r\n  }\r\n\r\n  /**\r\n   * Restaurant image URLs JSON.\r\n   */\r\n  static imageUrlForRestaurant(restaurant) {\r\n    const representationsURLs = DBHelper.imageRepresentationsPaths(restaurant.photograph);\r\n    return representationsURLs;\r\n  }\r\n\r\n  /**\r\n   * Paths for various image representations\r\n   */\r\n  static imageRepresentationsPaths(filename) {\r\n    const [folderName, suffix] = ['./img/', 'jpg'];\r\n    const large_1x = folderName.concat(filename, '-1024_1x', '.', suffix);\r\n    const large_2x = folderName.concat(filename, '-1024_2x', '.', suffix);\r\n    const small_1x = folderName.concat(filename, '-560_1x', '.', suffix);\r\n    const small_2x = folderName.concat(filename, '-560_2x', '.', suffix);\r\n\r\n    return {\r\n      large_1x: large_1x,\r\n      large_2x: large_2x,\r\n      small_1x: small_1x,\r\n      small_2x: small_2x\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Map marker for a restaurant.\r\n   */\r\n  static mapMarkerForRestaurant(restaurant, map) {\r\n    const marker = new google.maps.Marker({\r\n      position: restaurant.latlng,\r\n      title: restaurant.name,\r\n      url: DBHelper.urlForRestaurant(restaurant),\r\n      map: map,\r\n      animation: google.maps.Animation.DROP\r\n    });\r\n    return marker;\r\n  }\r\n\r\n}\r\nmodule.exports = DBHelper;","/**\n * Common image info class\n */\nclass ImageInfo {\n\n  static get ImageInfoData() {\n\n    return {\n      1: {\n        \"id\": 1,\n        \"photograph\": \"1\",\n        \"alt\": \"the main restaurant area\",\n        \"caption\": \"Large space with nice decoration\"\n      },\n      2: {\n        \"id\": 2,\n        \"photograph\": \"2\",\n        \"alt\": \"pizza on a plate\",\n        \"caption\": \"Tasty pizzas made every day\"\n      },\n      3: {\n        \"id\": 3,\n        \"photograph\": \"3.jpg\",\n        \"alt\": \"the main restaurant area empty\",\n        \"caption\": \"Modern design to enjoy your meals\",\n      },\n      4: {\n        \"id\": 4,\n        \"photograph\": \"4.jpg\",\n        \"alt\": \"the entrance of the shop\",\n        \"caption\": \"The corner shop, easy to spot\"\n      },\n      5: {\n        \"id\": 5,\n        \"photograph\": \"5.jpg\",\n        \"alt\": \"inside the shop, customers and staff\",\n        \"caption\": \"Meet our friendly staff\"\n      },\n      6: {\n        \"id\": 6,\n        \"photograph\": \"6.jpg\",\n        \"alt\": \"the area inside with some people queueing and other eating\",\n        \"caption\": \"Large space for big groups\"\n      },\n      7: {\n        \"id\": 7,\n        \"photograph\": \"7.jpg\",\n        \"alt\": \"black and white, the display of the shop with 2 people passing by\",\n        \"caption\": \"Our classic shop, still keeping our values\"\n      },\n      8: {\n        \"id\": 8,\n        \"name\": \"The Dutch\",\n        \"neighborhood\": \"Manhattan\",\n        \"photograph\": \"8.jpg\"\n      },\n      9: {\n        \"id\": 9,\n        \"photograph\": \"9.jpg\",\n        \"caption\": \"Enjoying our home made meals\",\n        \"alt\": \"black and white, people eating in the restaurant\"\n      },\n      10: {\n        \"id\": 10,\n        \"photograph\": \"10.jpg\",\n        \"alt\": \"the area inside the shop, the furniture and bar, without people\",\n        \"caption\": \"Modern space, ready to serve your appetite\"\n      }\n    }\n  }\n}\n\nmodule.exports = ImageInfo;","const DBHelper = require('./dbhelper');\n\nlet restaurant;\nvar map;\n\n/**\n * Initialize Google map, called from HTML.\n */\nwindow.initMap = () => {\n  fetchRestaurantFromURL((error, restaurant) => {\n    if (error) { // Got an error!\n      console.error(error);\n    } else {\n      this.map = new google.maps.Map(document.getElementById('map'), {\n        zoom: 16,\n        center: restaurant.latlng,\n        scrollwheel: false\n      });\n      fillBreadcrumb();\n      DBHelper.mapMarkerForRestaurant(this.restaurant, this.map);\n    }\n  });\n}\n\n/**\n * Get current restaurant from page URL.\n */\nfetchRestaurantFromURL = (callback) => {\n  if (this.restaurant) { // restaurant already fetched!\n    callback(null, this.restaurant)\n    return;\n  }\n  const id = getParameterByName('id');\n  if (!id) { // no id found in URL\n    error = 'No restaurant id in URL'\n    callback(error, null);\n  } else {\n    DBHelper.fetchRestaurantById(id, (error, restaurant) => {\n      this.restaurant = restaurant;\n      if (!restaurant) {\n        console.error(error);\n        return;\n      }\n      fillRestaurantHTML();\n      callback(null, restaurant)\n    });\n  }\n}\n\n/**\n * Create restaurant HTML and add it to the webpage\n */\nfillRestaurantHTML = (restaurant = this.restaurant) => {\n  const name = document.getElementById('restaurant-name');\n  name.innerHTML = restaurant.name;\n\n  const address = document.getElementById('restaurant-address');\n  address.innerHTML = restaurant.address;\n\n  if (restaurant.photograph) {\n    const picture = document.getElementById('restaurant-img');\n    picture.className = 'restaurant-img';\n    picture.setAttribute('aria-labelledby', \"fig_\" + restaurant.id);\n    picture.setAttribute('role', 'img');\n\n    const imageRepresentations = DBHelper.imageUrlForRestaurant(restaurant);\n    const sourceSmall = document.createElement('source');\n    sourceSmall.setAttribute('media', '(max-width:700px)')\n    sourceSmall.setAttribute('srcset',\n      imageRepresentations.small_1x\n      .concat(' 1x,')\n      .concat(imageRepresentations.small_2x)\n      .concat(' 2x')\n    );\n    picture.append(sourceSmall);\n\n    const sourceLarge = document.createElement('source');\n    sourceLarge.setAttribute('media', '(min-width:701px)')\n    sourceLarge.setAttribute('srcset',\n      imageRepresentations.large_1x\n      .concat(' 1x,')\n      .concat(imageRepresentations.large_2x)\n      .concat(' 2x')\n    );\n    picture.append(sourceLarge);\n\n    const image = document.createElement('img');\n    image.src = imageRepresentations.small_2x;\n    image.setAttribute('alt', 'restaurant '.concat(restaurant.name, ', ', restaurant.alt));\n    image.className = 'restaurant-img';\n    picture.append(image);\n\n    const figcaption = document.createElement('figcaption');\n    figcaption.setAttribute('id', \"fig_\" + restaurant.id)\n    figcaption.innerHTML = restaurant.caption;\n    picture.append(figcaption);\n  }\n\n  const cuisine = document.getElementById('restaurant-cuisine');\n  cuisine.innerHTML = restaurant.cuisine_type;\n\n  // fill operating hours\n  if (restaurant.operating_hours) {\n    fillRestaurantHoursHTML();\n  }\n  // fill reviews\n  fillReviewsHTML();\n}\n\n/**\n * Create restaurant operating hours HTML table and add it to the webpage.\n */\nfillRestaurantHoursHTML = (operatingHours = this.restaurant.operating_hours) => {\n  const hours = document.getElementById('restaurant-hours');\n  for (let key in operatingHours) {\n    const row = document.createElement('tr');\n\n    const day = document.createElement('td');\n    day.innerHTML = key;\n    row.appendChild(day);\n\n    const time = document.createElement('td');\n    time.innerHTML = operatingHours[key];\n    row.appendChild(time);\n\n    hours.appendChild(row);\n  }\n}\n\n/**\n * Create all reviews HTML and add them to the webpage.\n */\nfillReviewsHTML = (reviews = this.restaurant.reviews) => {\n  const container = document.getElementById('reviews-container');\n  const title = document.createElement('h2');\n  title.innerHTML = 'Reviews';\n  container.appendChild(title);\n\n  if (!reviews) {\n    const noReviews = document.createElement('p');\n    noReviews.innerHTML = 'No reviews yet!';\n    container.appendChild(noReviews);\n    return;\n  }\n  const ul = document.getElementById('reviews-list');\n  reviews.forEach(review => {\n    ul.appendChild(createReviewHTML(review));\n  });\n  container.appendChild(ul);\n}\n\n/**\n * Create review HTML and add it to the webpage.\n */\ncreateReviewHTML = (review) => {\n  const li = document.createElement('li');\n  const name = document.createElement('p');\n  name.innerHTML = review.name;\n  li.appendChild(name);\n\n  const date = document.createElement('p');\n  date.innerHTML = review.date;\n  li.appendChild(date);\n\n  const rating = document.createElement('p');\n  rating.innerHTML = `Rating: ${review.rating}`;\n  li.appendChild(rating);\n\n  const comments = document.createElement('p');\n  comments.innerHTML = review.comments;\n  li.appendChild(comments);\n\n  return li;\n}\n\n/**\n * Add restaurant name to the breadcrumb navigation menu\n */\nfillBreadcrumb = (restaurant = this.restaurant) => {\n  const breadcrumb = document.getElementById('breadcrumb');\n  const li = document.createElement('li');\n  const a_link = document.createElement('a');\n  a_link.setAttribute('href', '#');\n  a_link.setAttribute('aria-current', 'page');\n  a_link.setAttribute('class', 'current-page')\n  a_link.innerHTML = restaurant.name;\n  li.appendChild(a_link);\n  breadcrumb.appendChild(li);\n}\n\n/**\n * Get a parameter by name from page URL.\n */\ngetParameterByName = (name, url) => {\n  if (!url)\n    url = window.location.href;\n  name = name.replace(/[\\[\\]]/g, '\\\\$&');\n  const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),\n    results = regex.exec(url);\n  if (!results)\n    return null;\n  if (!results[2])\n    return '';\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZGJoZWxwZXIuanMiLCJzcmMvanMvaW1hZ2VzLmpzIiwic3JjL2pzL3Jlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLE1BQU0sWUFBWSxRQUFRLFVBQVIsQ0FBbEI7QUFDQTs7O0FBR0EsTUFBTSxRQUFOLENBQWU7O0FBRWI7Ozs7QUFJQSxhQUFXLFlBQVgsR0FBMEI7QUFDeEIsVUFBTSxPQUFPLGVBQWIsQ0FEd0IsQ0FDSztBQUM3QixXQUFRLG9CQUFtQixJQUFLLGNBQWhDO0FBQ0Q7O0FBRUQ7OztBQUdBLFNBQU8sZ0JBQVAsQ0FBd0IsUUFBeEIsRUFBa0M7QUFDaEMsUUFBSSxNQUFNLElBQUksY0FBSixFQUFWO0FBQ0EsUUFBSSxJQUFKLENBQVMsS0FBVCxFQUFnQixTQUFTLFlBQXpCO0FBQ0EsUUFBSSxNQUFKLEdBQWEsTUFBTTtBQUNqQixVQUFJLElBQUksTUFBSixLQUFlLEdBQW5CLEVBQXdCO0FBQUU7QUFDeEIsY0FBTSxjQUFjLEtBQUssS0FBTCxDQUFXLElBQUksWUFBZixDQUFwQjtBQUNBLGNBQU0sWUFBWSxVQUFVLGFBQTVCO0FBQ0Esb0JBQVksR0FBWixDQUFnQixVQUFVLFVBQVYsRUFBc0I7QUFDcEMsY0FBSSxXQUFXLFVBQWYsRUFBMkI7QUFDekIsdUJBQVcsR0FBWCxHQUFpQixVQUFVLFdBQVcsVUFBckIsRUFBaUMsR0FBbEQ7QUFDQSx1QkFBVyxPQUFYLEdBQXFCLFVBQVUsV0FBVyxVQUFyQixFQUFpQyxPQUF0RDtBQUNEO0FBQ0QsaUJBQU8sVUFBUDtBQUNELFNBTkQ7QUFPQSxpQkFBUyxJQUFULEVBQWUsV0FBZjtBQUNELE9BWEQsTUFXTztBQUFFO0FBQ1AsY0FBTSxRQUFVLHNDQUFxQyxJQUFJLE1BQU8sRUFBaEU7QUFDQSxpQkFBUyxLQUFULEVBQWdCLElBQWhCO0FBQ0Q7QUFDRixLQWhCRDtBQWlC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LGFBQWEsU0FBUyxjQUFULENBQXdCLFlBQXhCLENBQW5CO0FBQ0EsUUFBTSxLQUFLLFNBQVMsYUFBVCxDQUF1QixJQUF2QixDQUFYO0FBQ0EsUUFBTSxTQUFTLFNBQVMsYUFBVCxDQUF1QixHQUF2QixDQUFmO0FBQ0EsU0FBTyxZQUFQLENBQW9CLE1BQXBCLEVBQTRCLEdBQTVCO0FBQ0EsU0FBTyxZQUFQLENBQW9CLGNBQXBCLEVBQW9DLE1BQXBDO0FBQ0EsU0FBTyxZQUFQLENBQW9CLE9BQXBCLEVBQTZCLGNBQTdCO0FBQ0EsU0FBTyxTQUFQLEdBQW1CLFdBQVcsSUFBOUI7QUFDQSxLQUFHLFdBQUgsQ0FBZSxNQUFmO0FBQ0EsYUFBVyxXQUFYLENBQXVCLEVBQXZCO0FBQ0QsQ0FWRDs7QUFZQTs7O0FBR0EscUJBQXFCLENBQUMsSUFBRCxFQUFPLEdBQVAsS0FBZTtBQUNsQyxNQUFJLENBQUMsR0FBTCxFQUNFLE1BQU0sT0FBTyxRQUFQLENBQWdCLElBQXRCO0FBQ0YsU0FBTyxLQUFLLE9BQUwsQ0FBYSxTQUFiLEVBQXdCLE1BQXhCLENBQVA7QUFDQSxRQUFNLFFBQVEsSUFBSSxNQUFKLENBQVksT0FBTSxJQUFLLG1CQUF2QixDQUFkO0FBQUEsUUFDRSxVQUFVLE1BQU0sSUFBTixDQUFXLEdBQVgsQ0FEWjtBQUVBLE1BQUksQ0FBQyxPQUFMLEVBQ0UsT0FBTyxJQUFQO0FBQ0YsTUFBSSxDQUFDLFFBQVEsQ0FBUixDQUFMLEVBQ0UsT0FBTyxFQUFQO0FBQ0YsU0FBTyxtQkFBbUIsUUFBUSxDQUFSLEVBQVcsT0FBWCxDQUFtQixLQUFuQixFQUEwQixHQUExQixDQUFuQixDQUFQO0FBQ0QsQ0FYRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJjb25zdCBJbWFnZUluZm8gPSByZXF1aXJlKCcuL2ltYWdlcycpXHJcbi8qKlxyXG4gKiBDb21tb24gZGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucy5cclxuICovXHJcbmNsYXNzIERCSGVscGVyIHtcclxuXHJcbiAgLyoqXHJcbiAgICogRGF0YWJhc2UgVVJMLlxyXG4gICAqIENoYW5nZSB0aGlzIHRvIHJlc3RhdXJhbnRzLmpzb24gZmlsZSBsb2NhdGlvbiBvbiB5b3VyIHNlcnZlci5cclxuICAgKi9cclxuICBzdGF0aWMgZ2V0IERBVEFCQVNFX1VSTCgpIHtcclxuICAgIGNvbnN0IHBvcnQgPSAnQEBzZXJ2ZXJfcG9ydCcgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxyXG4gICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0vcmVzdGF1cmFudHNgO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIHJlc3RhdXJhbnRzLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRzKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICB4aHIub3BlbignR0VUJywgREJIZWxwZXIuREFUQUJBU0VfVVJMKTtcclxuICAgIHhoci5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHsgLy8gR290IGEgc3VjY2VzcyByZXNwb25zZSBmcm9tIHNlcnZlciFcclxuICAgICAgICBjb25zdCByZXN0YXVyYW50cyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgY29uc3QgaW1hZ2VEYXRhID0gSW1hZ2VJbmZvLkltYWdlSW5mb0RhdGE7XHJcbiAgICAgICAgcmVzdGF1cmFudHMubWFwKGZ1bmN0aW9uIChyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgICBpZiAocmVzdGF1cmFudC5waG90b2dyYXBoKSB7XHJcbiAgICAgICAgICAgIHJlc3RhdXJhbnQuYWx0ID0gaW1hZ2VEYXRhW3Jlc3RhdXJhbnQucGhvdG9ncmFwaF0uYWx0O1xyXG4gICAgICAgICAgICByZXN0YXVyYW50LmNhcHRpb24gPSBpbWFnZURhdGFbcmVzdGF1cmFudC5waG90b2dyYXBoXS5jYXB0aW9uO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHJlc3RhdXJhbnQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudHMpO1xyXG4gICAgICB9IGVsc2UgeyAvLyBPb3BzIS4gR290IGFuIGVycm9yIGZyb20gc2VydmVyLlxyXG4gICAgICAgIGNvbnN0IGVycm9yID0gKGBSZXF1ZXN0IGZhaWxlZC4gUmV0dXJuZWQgc3RhdHVzIG9mICR7eGhyLnN0YXR1c31gKTtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB4aHIuc2VuZCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgIHhoci5vcGVuKCdHRVQnLCBEQkhlbHBlci5EQVRBQkFTRV9VUkwgKyAnLycgKyBpZCk7XHJcbiAgICB4aHIub25sb2FkID0gKCkgPT4ge1xyXG4gICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjAwKSB7IC8vIEdvdCBhIHN1Y2Nlc3MgcmVzcG9uc2UgZnJvbSBzZXJ2ZXIhXHJcbiAgICAgICAgY29uc3QgcmVzdGF1cmFudCA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgaWYgKHJlc3RhdXJhbnQucGhvdG9ncmFwaCkge1xyXG4gICAgICAgICAgY29uc3QgaW1hZ2VEYXRhID0gSW1hZ2VJbmZvLkltYWdlSW5mb0RhdGE7XHJcbiAgICAgICAgICByZXN0YXVyYW50LmFsdCA9IGltYWdlRGF0YVtyZXN0YXVyYW50LnBob3RvZ3JhcGhdLmFsdDtcclxuICAgICAgICAgIHJlc3RhdXJhbnQuY2FwdGlvbiA9IGltYWdlRGF0YVtyZXN0YXVyYW50LnBob3RvZ3JhcGhdLmNhcHRpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xyXG4gICAgICB9IGVsc2UgeyAvLyBPb3BzIS4gR290IGFuIGVycm9yIGZyb20gc2VydmVyLlxyXG4gICAgICAgIGNvbnN0IGVycm9yID0gKGBSZXF1ZXN0IGZhaWxlZC4gUmV0dXJuZWQgc3RhdHVzIG9mICR7eGhyLnN0YXR1c31gKTtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB4aHIuc2VuZCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIHR5cGUgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZShjdWlzaW5lLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzICB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZ1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIGN1aXNpbmUgdHlwZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QobmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gbmVpZ2hib3Job29kXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsZXQgcmVzdWx0cyA9IHJlc3RhdXJhbnRzXHJcbiAgICAgICAgaWYgKGN1aXNpbmUgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IGN1aXNpbmVcclxuICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmVpZ2hib3Job29kICE9ICdhbGwnKSB7IC8vIGZpbHRlciBieSBuZWlnaGJvcmhvb2RcclxuICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaE5laWdoYm9yaG9vZHMoY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBHZXQgYWxsIG5laWdoYm9yaG9vZHMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2QpXHJcbiAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXHJcbiAgICAgICAgY29uc3QgdW5pcXVlTmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHMuZmlsdGVyKCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaSlcclxuICAgICAgICBjYWxsYmFjayhudWxsLCB1bmlxdWVOZWlnaGJvcmhvb2RzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoQ3Vpc2luZXMoY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBHZXQgYWxsIGN1aXNpbmVzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgY3Vpc2luZXMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLmN1aXNpbmVfdHlwZSlcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGN1aXNpbmVzXHJcbiAgICAgICAgY29uc3QgdW5pcXVlQ3Vpc2luZXMgPSBjdWlzaW5lcy5maWx0ZXIoKHYsIGkpID0+IGN1aXNpbmVzLmluZGV4T2YodikgPT0gaSlcclxuICAgICAgICBjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBwYWdlIFVSTC5cclxuICAgKi9cclxuICBzdGF0aWMgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTHMgSlNPTi5cclxuICAgKi9cclxuICBzdGF0aWMgaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIGNvbnN0IHJlcHJlc2VudGF0aW9uc1VSTHMgPSBEQkhlbHBlci5pbWFnZVJlcHJlc2VudGF0aW9uc1BhdGhzKHJlc3RhdXJhbnQucGhvdG9ncmFwaCk7XHJcbiAgICByZXR1cm4gcmVwcmVzZW50YXRpb25zVVJMcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhdGhzIGZvciB2YXJpb3VzIGltYWdlIHJlcHJlc2VudGF0aW9uc1xyXG4gICAqL1xyXG4gIHN0YXRpYyBpbWFnZVJlcHJlc2VudGF0aW9uc1BhdGhzKGZpbGVuYW1lKSB7XHJcbiAgICBjb25zdCBbZm9sZGVyTmFtZSwgc3VmZml4XSA9IFsnLi9pbWcvJywgJ2pwZyddO1xyXG4gICAgY29uc3QgbGFyZ2VfMXggPSBmb2xkZXJOYW1lLmNvbmNhdChmaWxlbmFtZSwgJy0xMDI0XzF4JywgJy4nLCBzdWZmaXgpO1xyXG4gICAgY29uc3QgbGFyZ2VfMnggPSBmb2xkZXJOYW1lLmNvbmNhdChmaWxlbmFtZSwgJy0xMDI0XzJ4JywgJy4nLCBzdWZmaXgpO1xyXG4gICAgY29uc3Qgc21hbGxfMXggPSBmb2xkZXJOYW1lLmNvbmNhdChmaWxlbmFtZSwgJy01NjBfMXgnLCAnLicsIHN1ZmZpeCk7XHJcbiAgICBjb25zdCBzbWFsbF8yeCA9IGZvbGRlck5hbWUuY29uY2F0KGZpbGVuYW1lLCAnLTU2MF8yeCcsICcuJywgc3VmZml4KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsYXJnZV8xeDogbGFyZ2VfMXgsXHJcbiAgICAgIGxhcmdlXzJ4OiBsYXJnZV8yeCxcclxuICAgICAgc21hbGxfMXg6IHNtYWxsXzF4LFxyXG4gICAgICBzbWFsbF8yeDogc21hbGxfMnhcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXHJcbiAgICovXHJcbiAgc3RhdGljIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XHJcbiAgICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcclxuICAgICAgcG9zaXRpb246IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICB0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxyXG4gICAgICB1cmw6IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCksXHJcbiAgICAgIG1hcDogbWFwLFxyXG4gICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBtYXJrZXI7XHJcbiAgfVxyXG5cclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IERCSGVscGVyOyIsIi8qKlxuICogQ29tbW9uIGltYWdlIGluZm8gY2xhc3NcbiAqL1xuY2xhc3MgSW1hZ2VJbmZvIHtcblxuICBzdGF0aWMgZ2V0IEltYWdlSW5mb0RhdGEoKSB7XG5cbiAgICByZXR1cm4ge1xuICAgICAgMToge1xuICAgICAgICBcImlkXCI6IDEsXG4gICAgICAgIFwicGhvdG9ncmFwaFwiOiBcIjFcIixcbiAgICAgICAgXCJhbHRcIjogXCJ0aGUgbWFpbiByZXN0YXVyYW50IGFyZWFcIixcbiAgICAgICAgXCJjYXB0aW9uXCI6IFwiTGFyZ2Ugc3BhY2Ugd2l0aCBuaWNlIGRlY29yYXRpb25cIlxuICAgICAgfSxcbiAgICAgIDI6IHtcbiAgICAgICAgXCJpZFwiOiAyLFxuICAgICAgICBcInBob3RvZ3JhcGhcIjogXCIyXCIsXG4gICAgICAgIFwiYWx0XCI6IFwicGl6emEgb24gYSBwbGF0ZVwiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJUYXN0eSBwaXp6YXMgbWFkZSBldmVyeSBkYXlcIlxuICAgICAgfSxcbiAgICAgIDM6IHtcbiAgICAgICAgXCJpZFwiOiAzLFxuICAgICAgICBcInBob3RvZ3JhcGhcIjogXCIzLmpwZ1wiLFxuICAgICAgICBcImFsdFwiOiBcInRoZSBtYWluIHJlc3RhdXJhbnQgYXJlYSBlbXB0eVwiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJNb2Rlcm4gZGVzaWduIHRvIGVuam95IHlvdXIgbWVhbHNcIixcbiAgICAgIH0sXG4gICAgICA0OiB7XG4gICAgICAgIFwiaWRcIjogNCxcbiAgICAgICAgXCJwaG90b2dyYXBoXCI6IFwiNC5qcGdcIixcbiAgICAgICAgXCJhbHRcIjogXCJ0aGUgZW50cmFuY2Ugb2YgdGhlIHNob3BcIixcbiAgICAgICAgXCJjYXB0aW9uXCI6IFwiVGhlIGNvcm5lciBzaG9wLCBlYXN5IHRvIHNwb3RcIlxuICAgICAgfSxcbiAgICAgIDU6IHtcbiAgICAgICAgXCJpZFwiOiA1LFxuICAgICAgICBcInBob3RvZ3JhcGhcIjogXCI1LmpwZ1wiLFxuICAgICAgICBcImFsdFwiOiBcImluc2lkZSB0aGUgc2hvcCwgY3VzdG9tZXJzIGFuZCBzdGFmZlwiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJNZWV0IG91ciBmcmllbmRseSBzdGFmZlwiXG4gICAgICB9LFxuICAgICAgNjoge1xuICAgICAgICBcImlkXCI6IDYsXG4gICAgICAgIFwicGhvdG9ncmFwaFwiOiBcIjYuanBnXCIsXG4gICAgICAgIFwiYWx0XCI6IFwidGhlIGFyZWEgaW5zaWRlIHdpdGggc29tZSBwZW9wbGUgcXVldWVpbmcgYW5kIG90aGVyIGVhdGluZ1wiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJMYXJnZSBzcGFjZSBmb3IgYmlnIGdyb3Vwc1wiXG4gICAgICB9LFxuICAgICAgNzoge1xuICAgICAgICBcImlkXCI6IDcsXG4gICAgICAgIFwicGhvdG9ncmFwaFwiOiBcIjcuanBnXCIsXG4gICAgICAgIFwiYWx0XCI6IFwiYmxhY2sgYW5kIHdoaXRlLCB0aGUgZGlzcGxheSBvZiB0aGUgc2hvcCB3aXRoIDIgcGVvcGxlIHBhc3NpbmcgYnlcIixcbiAgICAgICAgXCJjYXB0aW9uXCI6IFwiT3VyIGNsYXNzaWMgc2hvcCwgc3RpbGwga2VlcGluZyBvdXIgdmFsdWVzXCJcbiAgICAgIH0sXG4gICAgICA4OiB7XG4gICAgICAgIFwiaWRcIjogOCxcbiAgICAgICAgXCJuYW1lXCI6IFwiVGhlIER1dGNoXCIsXG4gICAgICAgIFwibmVpZ2hib3Job29kXCI6IFwiTWFuaGF0dGFuXCIsXG4gICAgICAgIFwicGhvdG9ncmFwaFwiOiBcIjguanBnXCJcbiAgICAgIH0sXG4gICAgICA5OiB7XG4gICAgICAgIFwiaWRcIjogOSxcbiAgICAgICAgXCJwaG90b2dyYXBoXCI6IFwiOS5qcGdcIixcbiAgICAgICAgXCJjYXB0aW9uXCI6IFwiRW5qb3lpbmcgb3VyIGhvbWUgbWFkZSBtZWFsc1wiLFxuICAgICAgICBcImFsdFwiOiBcImJsYWNrIGFuZCB3aGl0ZSwgcGVvcGxlIGVhdGluZyBpbiB0aGUgcmVzdGF1cmFudFwiXG4gICAgICB9LFxuICAgICAgMTA6IHtcbiAgICAgICAgXCJpZFwiOiAxMCxcbiAgICAgICAgXCJwaG90b2dyYXBoXCI6IFwiMTAuanBnXCIsXG4gICAgICAgIFwiYWx0XCI6IFwidGhlIGFyZWEgaW5zaWRlIHRoZSBzaG9wLCB0aGUgZnVybml0dXJlIGFuZCBiYXIsIHdpdGhvdXQgcGVvcGxlXCIsXG4gICAgICAgIFwiY2FwdGlvblwiOiBcIk1vZGVybiBzcGFjZSwgcmVhZHkgdG8gc2VydmUgeW91ciBhcHBldGl0ZVwiXG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gSW1hZ2VJbmZvOyIsImNvbnN0IERCSGVscGVyID0gcmVxdWlyZSgnLi9kYmhlbHBlcicpO1xuXG5sZXQgcmVzdGF1cmFudDtcbnZhciBtYXA7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcbiAgICAgICAgem9vbTogMTYsXG4gICAgICAgIGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xuICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudCh0aGlzLnJlc3RhdXJhbnQsIHRoaXMubWFwKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9IChjYWxsYmFjaykgPT4ge1xuICBpZiAodGhpcy5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxuICAgIGNhbGxiYWNrKG51bGwsIHRoaXMucmVzdGF1cmFudClcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XG4gIGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXG4gICAgZXJyb3IgPSAnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xuICB9IGVsc2Uge1xuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgICAgdGhpcy5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZmlsbFJlc3RhdXJhbnRIVE1MKCk7XG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXG4gKi9cbmZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gdGhpcy5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuXG4gIGlmIChyZXN0YXVyYW50LnBob3RvZ3JhcGgpIHtcbiAgICBjb25zdCBwaWN0dXJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJyk7XG4gICAgcGljdHVyZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xuICAgIHBpY3R1cmUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCBcImZpZ19cIiArIHJlc3RhdXJhbnQuaWQpO1xuICAgIHBpY3R1cmUuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2ltZycpO1xuXG4gICAgY29uc3QgaW1hZ2VSZXByZXNlbnRhdGlvbnMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG4gICAgY29uc3Qgc291cmNlU21hbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcbiAgICBzb3VyY2VTbWFsbC5zZXRBdHRyaWJ1dGUoJ21lZGlhJywgJyhtYXgtd2lkdGg6NzAwcHgpJylcbiAgICBzb3VyY2VTbWFsbC5zZXRBdHRyaWJ1dGUoJ3NyY3NldCcsXG4gICAgICBpbWFnZVJlcHJlc2VudGF0aW9ucy5zbWFsbF8xeFxuICAgICAgLmNvbmNhdCgnIDF4LCcpXG4gICAgICAuY29uY2F0KGltYWdlUmVwcmVzZW50YXRpb25zLnNtYWxsXzJ4KVxuICAgICAgLmNvbmNhdCgnIDJ4JylcbiAgICApO1xuICAgIHBpY3R1cmUuYXBwZW5kKHNvdXJjZVNtYWxsKTtcblxuICAgIGNvbnN0IHNvdXJjZUxhcmdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG4gICAgc291cmNlTGFyZ2Uuc2V0QXR0cmlidXRlKCdtZWRpYScsICcobWluLXdpZHRoOjcwMXB4KScpXG4gICAgc291cmNlTGFyZ2Uuc2V0QXR0cmlidXRlKCdzcmNzZXQnLFxuICAgICAgaW1hZ2VSZXByZXNlbnRhdGlvbnMubGFyZ2VfMXhcbiAgICAgIC5jb25jYXQoJyAxeCwnKVxuICAgICAgLmNvbmNhdChpbWFnZVJlcHJlc2VudGF0aW9ucy5sYXJnZV8yeClcbiAgICAgIC5jb25jYXQoJyAyeCcpXG4gICAgKTtcbiAgICBwaWN0dXJlLmFwcGVuZChzb3VyY2VMYXJnZSk7XG5cbiAgICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGltYWdlLnNyYyA9IGltYWdlUmVwcmVzZW50YXRpb25zLnNtYWxsXzJ4O1xuICAgIGltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgJ3Jlc3RhdXJhbnQgJy5jb25jYXQocmVzdGF1cmFudC5uYW1lLCAnLCAnLCByZXN0YXVyYW50LmFsdCkpO1xuICAgIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XG4gICAgcGljdHVyZS5hcHBlbmQoaW1hZ2UpO1xuXG4gICAgY29uc3QgZmlnY2FwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ZpZ2NhcHRpb24nKTtcbiAgICBmaWdjYXB0aW9uLnNldEF0dHJpYnV0ZSgnaWQnLCBcImZpZ19cIiArIHJlc3RhdXJhbnQuaWQpXG4gICAgZmlnY2FwdGlvbi5pbm5lckhUTUwgPSByZXN0YXVyYW50LmNhcHRpb247XG4gICAgcGljdHVyZS5hcHBlbmQoZmlnY2FwdGlvbik7XG4gIH1cblxuICBjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpO1xuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xuXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKCk7XG4gIH1cbiAgLy8gZmlsbCByZXZpZXdzXG4gIGZpbGxSZXZpZXdzSFRNTCgpO1xufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gdGhpcy5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG5cbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xuXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJldmlld3NIVE1MID0gKHJldmlld3MgPSB0aGlzLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKTtcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cbiAgaWYgKCFyZXZpZXdzKSB7XG4gICAgY29uc3Qgbm9SZXZpZXdzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XG4gIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XG4gIH0pO1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpO1xufVxuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWU7XG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpO1xuXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGRhdGUuaW5uZXJIVE1MID0gcmV2aWV3LmRhdGU7XG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xuXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gO1xuICBsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xuXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcblxuICByZXR1cm4gbGk7XG59XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xuZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudCA9IHRoaXMucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBicmVhZGNydW1iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JyZWFkY3J1bWInKTtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBjb25zdCBhX2xpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gIGFfbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnIycpO1xuICBhX2xpbmsuc2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnLCAncGFnZScpO1xuICBhX2xpbmsuc2V0QXR0cmlidXRlKCdjbGFzcycsICdjdXJyZW50LXBhZ2UnKVxuICBhX2xpbmsuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuICBsaS5hcHBlbmRDaGlsZChhX2xpbmspO1xuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcbn1cblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG5nZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG4gIGlmICghdXJsKVxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG4gIGlmICghcmVzdWx0cylcbiAgICByZXR1cm4gbnVsbDtcbiAgaWYgKCFyZXN1bHRzWzJdKVxuICAgIHJldHVybiAnJztcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn0iXX0="}