{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/idb/lib/idb.js","src/js/dbhelper.js","src/js/images.js","src/js/restaurant_info.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"bundle_restaurant.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n","const ImageInfo = require('./images');\r\nconst idb = require('idb');\r\n/**\r\n * Common database helper functions.\r\n */\r\nclass DBHelper {\r\n\r\n  /**\r\n   * Database URL.\r\n   * Change this to restaurants.json file location on your server.\r\n   */\r\n  static get DATABASE_URL() {\r\n    const port = '@@server_port' // Change this to your server port\r\n    return `http://localhost:${port}/restaurants`;\r\n  }\r\n\r\n  static initIndexedDB() {\r\n    this.dbPromise = idb.open('restaurant-db', 1, function (upgradeDb) {\r\n      switch (upgradeDb.oldVersion) {\r\n        case 0:\r\n        case 1:\r\n          const restaurantStore = upgradeDb.createObjectStore('restaurants', {\r\n            keyPath: 'id'\r\n          });\r\n          restaurantStore.createIndex('photographs', 'photograph');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch all restaurants.\r\n   */\r\n  static fetchRestaurants(callback) {\r\n    var self = this;\r\n\r\n    DBHelper.fetchRestaurantsFromStorage().then((restaurants) => {\r\n      callback(null, restaurants);\r\n    });\r\n\r\n    let xhr = new XMLHttpRequest();\r\n    xhr.open('GET', DBHelper.DATABASE_URL);\r\n    xhr.onload = () => {\r\n      if (xhr.status === 200) { // Got a success response from server!\r\n        const restaurants = JSON.parse(xhr.responseText);\r\n        const imageData = ImageInfo.ImageInfoData;\r\n        restaurants.map(function (restaurant) {\r\n          if (restaurant.photograph) {\r\n            restaurant.alt = imageData[restaurant.photograph].alt;\r\n            restaurant.caption = imageData[restaurant.photograph].caption;\r\n          }\r\n          self.dbPromise.then(function (db) {\r\n            var tx = db.transaction('restaurants', 'readwrite');\r\n            var restaurantStore = tx.objectStore('restaurants');\r\n            return restaurantStore.put(restaurant);\r\n          });\r\n          return restaurant;\r\n        });\r\n        callback(null, restaurants);\r\n      } else { // Oops!. Got an error from server.\r\n        this.dbPromise.then(() => {\r\n          return DBHelper.fetchRestaurantsFromStorage()\r\n        }).then(function (restaurants) {\r\n          callback(null, restaurants);\r\n        }).catch(function () {\r\n          const error = (`Request failed.`);\r\n          callback(error, null);\r\n        });\r\n      }\r\n    };\r\n    xhr.onerror = function () {\r\n      DBHelper.fetchRestaurantsFromStorage().then((restaurants) => {\r\n        callback(null, restaurants);\r\n      });\r\n    }\r\n    xhr.send();\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants from indecedDB\r\n   */\r\n  static fetchRestaurantsFromStorage() {\r\n    return this.dbPromise.then(function (db) {\r\n      var tx = db.transaction('restaurants');\r\n      var restaurantsStore = tx.objectStore('restaurants');\r\n      return restaurantsStore.getAll();\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurant by Id from indecedDB\r\n   */\r\n  static fetchRestaurantFromStorage(id) {\r\n    return this.dbPromise.then(function (db) {\r\n      var tx = db.transaction('restaurants');\r\n      var restaurantsStore = tx.objectStore('restaurants');\r\n      return restaurantsStore.get(parseInt(id));\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Fetch a restaurant by its ID.\r\n   */\r\n  static fetchRestaurantById(id, callback) {\r\n    var self = this;\r\n\r\n    let xhr = new XMLHttpRequest();\r\n    xhr.open('GET', DBHelper.DATABASE_URL + '/' + id);\r\n    xhr.onload = () => {\r\n      if (xhr.status === 200) { // Got a success response from server!\r\n        const restaurant = JSON.parse(xhr.responseText);\r\n        if (restaurant.photograph) {\r\n          const imageData = ImageInfo.ImageInfoData;\r\n          restaurant.alt = imageData[restaurant.photograph].alt;\r\n          restaurant.caption = imageData[restaurant.photograph].caption;\r\n        }\r\n        self.dbPromise.then(function (db) {\r\n          var tx = db.transaction('restaurants', 'readwrite');\r\n          var restaurantStore = tx.objectStore('restaurants');\r\n          return restaurantStore.put(restaurant);\r\n        })\r\n        callback(null, restaurant);\r\n      } else { // Oops!. Got an error from server.\r\n        this.dbPromise.then(() => {\r\n          return DBHelper.fetchRestaurantFromStorage(id)\r\n        }).then(function (restaurant) {\r\n          callback(null, restaurant);\r\n        }).catch(function () {\r\n          const error = (`Request failed.`);\r\n          callback(error, null);\r\n        });\r\n      }\r\n    };\r\n    xhr.onerror = function () {\r\n      DBHelper.fetchRestaurantFromStorage(id).then(function (restaurant) {\r\n        callback(null, restaurant);\r\n      });\r\n    }\r\n    xhr.send();\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a cuisine type with proper error handling.\r\n   */\r\n  static fetchRestaurantByCuisine(cuisine, callback) {\r\n    // Fetch all restaurants  with proper error handling\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given cuisine type\r\n        const results = restaurants.filter(r => r.cuisine_type == cuisine);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a neighborhood with proper error handling.\r\n   */\r\n  static fetchRestaurantByNeighborhood(neighborhood, callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given neighborhood\r\n        const results = restaurants.filter(r => r.neighborhood == neighborhood);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n   */\r\n  static fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        let results = restaurants\r\n        if (cuisine != 'all') { // filter by cuisine\r\n          results = results.filter(r => r.cuisine_type == cuisine);\r\n        }\r\n        if (neighborhood != 'all') { // filter by neighborhood\r\n          results = results.filter(r => r.neighborhood == neighborhood);\r\n        }\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch all neighborhoods with proper error handling.\r\n   */\r\n  static fetchNeighborhoods(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all neighborhoods from all restaurants\r\n        const neighborhoods = restaurants.map((v, i) => restaurants[i].neighborhood)\r\n        // Remove duplicates from neighborhoods\r\n        const uniqueNeighborhoods = neighborhoods.filter((v, i) => neighborhoods.indexOf(v) == i)\r\n        callback(null, uniqueNeighborhoods);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch all cuisines with proper error handling.\r\n   */\r\n  static fetchCuisines(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all cuisines from all restaurants\r\n        const cuisines = restaurants.map((v, i) => restaurants[i].cuisine_type)\r\n        // Remove duplicates from cuisines\r\n        const uniqueCuisines = cuisines.filter((v, i) => cuisines.indexOf(v) == i)\r\n        callback(null, uniqueCuisines);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Restaurant page URL.\r\n   */\r\n  static urlForRestaurant(restaurant) {\r\n    return (`./restaurant.html?id=${restaurant.id}`);\r\n  }\r\n\r\n  /**\r\n   * Restaurant image URLs JSON.\r\n   */\r\n  static imageUrlForRestaurant(restaurant) {\r\n    const representationsURLs = DBHelper.imageRepresentationsPaths(restaurant.photograph);\r\n    return representationsURLs;\r\n  }\r\n\r\n  /**\r\n   * Paths for various image representations\r\n   */\r\n  static imageRepresentationsPaths(filename) {\r\n    const [folderName, suffix] = ['./img/', 'jpg'] //,'webp'];\r\n    const large_1x = folderName.concat(filename, '-512_1x', '.', suffix);\r\n    const large_2x = folderName.concat(filename, '-512_2x', '.', suffix);\r\n    const small_1x = folderName.concat(filename, '-380_1x', '.', suffix);\r\n    const small_2x = folderName.concat(filename, '-380_2x', '.', suffix);\r\n\r\n    return {\r\n      large_1x: large_1x,\r\n      large_2x: large_2x,\r\n      small_1x: small_1x,\r\n      small_2x: small_2x\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Map marker for a restaurant.\r\n   */\r\n  static mapMarkerForRestaurant(restaurant, map) {\r\n    const marker = new google.maps.Marker({\r\n      position: restaurant.latlng,\r\n      title: restaurant.name,\r\n      url: DBHelper.urlForRestaurant(restaurant),\r\n      map: map,\r\n      animation: google.maps.Animation.DROP\r\n    });\r\n    return marker;\r\n  }\r\n\r\n}\r\nmodule.exports = DBHelper;","/**\n * Common image info class\n */\nclass ImageInfo {\n\n  static get ImageInfoData() {\n\n    return {\n      1: {\n        \"id\": 1,\n        \"photograph\": \"1\",\n        \"alt\": \"the main restaurant area\",\n        \"caption\": \"Large space with nice decoration\"\n      },\n      2: {\n        \"id\": 2,\n        \"photograph\": \"2\",\n        \"alt\": \"pizza on a plate\",\n        \"caption\": \"Tasty pizzas made every day\"\n      },\n      3: {\n        \"id\": 3,\n        \"photograph\": \"3\",\n        \"alt\": \"the main restaurant area empty\",\n        \"caption\": \"Modern design to enjoy your meals\",\n      },\n      4: {\n        \"id\": 4,\n        \"photograph\": \"4\",\n        \"alt\": \"the entrance of the shop\",\n        \"caption\": \"The corner shop, easy to spot\"\n      },\n      5: {\n        \"id\": 5,\n        \"photograph\": \"5\",\n        \"alt\": \"inside the shop, customers and staff\",\n        \"caption\": \"Meet our friendly staff\"\n      },\n      6: {\n        \"id\": 6,\n        \"photograph\": \"6\",\n        \"alt\": \"the area inside with some people queueing and other eating\",\n        \"caption\": \"Large space for big groups\"\n      },\n      7: {\n        \"id\": 7,\n        \"photograph\": \"7\",\n        \"alt\": \"black and white, the display of the shop with 2 people passing by\",\n        \"caption\": \"Our classic shop, still keeping our values\"\n      },\n      8: {\n        \"id\": 8,\n        \"photograph\": \"8\",\n        \"alt\": \"outdoor display of the corner shop, big label reads 'the Dutch'\",\n        \"caption\": \"Easy to find our beautiful building\",\n      },\n      9: {\n        \"id\": 9,\n        \"photograph\": \"9\",\n        \"caption\": \"Enjoying our home made meals\",\n        \"alt\": \"black and white, people eating in the restaurant\"\n      },\n      10: {\n        \"id\": 10,\n        \"photograph\": \"10\",\n        \"alt\": \"the area inside the shop, the furniture and bar, without people\",\n        \"caption\": \"Modern space, ready to serve your appetite\"\n      }\n    }\n  }\n}\n\nmodule.exports = ImageInfo;","const DBHelper = require('./dbhelper');\n\nlet restaurant;\nvar map;\n\n/**\n * Initialize Google map, called from HTML.\n */\nwindow.initMap = () => {\n  fetchRestaurantFromURL((error, restaurant) => {\n    if (error) { // Got an error!\n      console.error(error);\n    } else {\n      this.map = new google.maps.Map(document.getElementById('map'), {\n        zoom: 16,\n        center: restaurant.latlng,\n        scrollwheel: false\n      });\n      fillBreadcrumb();\n      DBHelper.mapMarkerForRestaurant(this.restaurant, this.map);\n    }\n  });\n}\n\n/**\n * Initialise indexedDB\n */\nDBHelper.initIndexedDB();\n\n\n/**\n * Get current restaurant from page URL.\n */\nfetchRestaurantFromURL = (callback) => {\n  if (this.restaurant) { // restaurant already fetched!\n    callback(null, this.restaurant)\n    return;\n  }\n  const id = getParameterByName('id');\n  if (!id) { // no id found in URL\n    error = 'No restaurant id in URL'\n    callback(error, null);\n  } else {\n    DBHelper.fetchRestaurantById(id, (error, restaurant) => {\n      this.restaurant = restaurant;\n      if (!restaurant) {\n        console.error(error);\n        return;\n      }\n      fillRestaurantHTML();\n      callback(null, restaurant)\n    });\n  }\n}\n\n/**\n * Create restaurant HTML and add it to the webpage\n */\nfillRestaurantHTML = (restaurant = this.restaurant) => {\n  const name = document.getElementById('restaurant-name');\n  name.innerHTML = restaurant.name;\n\n  const address = document.getElementById('restaurant-address');\n  address.innerHTML = restaurant.address;\n\n  if (restaurant.photograph) {\n    const picture = document.getElementById('restaurant-img');\n    picture.className = 'restaurant-img';\n    picture.setAttribute('aria-labelledby', \"fig_\" + restaurant.id);\n    picture.setAttribute('role', 'img');\n\n    const imageRepresentations = DBHelper.imageUrlForRestaurant(restaurant);\n    const sourceSmall = document.createElement('source');\n    sourceSmall.setAttribute('media', '(max-width:700px)')\n    sourceSmall.setAttribute('srcset',\n      imageRepresentations.small_1x\n        .concat(' 1x,')\n        .concat(imageRepresentations.small_2x)\n        .concat(' 2x')\n    );\n    picture.append(sourceSmall);\n\n    const sourceLarge = document.createElement('source');\n    sourceLarge.setAttribute('media', '(min-width:701px)')\n    sourceLarge.setAttribute('srcset',\n      imageRepresentations.large_1x\n        .concat(' 1x,')\n        .concat(imageRepresentations.large_2x)\n        .concat(' 2x')\n    );\n    picture.append(sourceLarge);\n\n    const image = document.createElement('img');\n    image.src = imageRepresentations.small_2x;\n    image.setAttribute('alt', 'restaurant '.concat(restaurant.name, ', ', restaurant.alt));\n    image.className = 'restaurant-img';\n    picture.append(image);\n\n    const figcaption = document.createElement('figcaption');\n    figcaption.setAttribute('id', \"fig_\" + restaurant.id)\n    figcaption.innerHTML = restaurant.caption;\n    picture.append(figcaption);\n  }\n\n  const cuisine = document.getElementById('restaurant-cuisine');\n  cuisine.innerHTML = restaurant.cuisine_type;\n\n  // fill operating hours\n  if (restaurant.operating_hours) {\n    fillRestaurantHoursHTML();\n  }\n  // fill reviews\n  fillReviewsHTML();\n  fillSubmitReviewsHTML();\n}\n\n/**\n * Create restaurant operating hours HTML table and add it to the webpage.\n */\nfillRestaurantHoursHTML = (operatingHours = this.restaurant.operating_hours) => {\n  const hours = document.getElementById('restaurant-hours');\n  for (let key in operatingHours) {\n    const row = document.createElement('tr');\n\n    const day = document.createElement('td');\n    day.innerHTML = key;\n    row.appendChild(day);\n\n    const time = document.createElement('td');\n    time.innerHTML = operatingHours[key];\n    row.appendChild(time);\n\n    hours.appendChild(row);\n  }\n}\n\n/**\n * Create all reviews HTML and add them to the webpage.\n */\nfillReviewsHTML = (reviews = this.restaurant.reviews) => {\n  const container = document.getElementById('reviews-container');\n  const title = document.createElement('h2');\n  title.innerHTML = 'Reviews';\n  container.appendChild(title);\n\n  if (!reviews) {\n    const noReviews = document.createElement('p');\n    noReviews.innerHTML = 'No reviews yet!';\n    container.appendChild(noReviews);\n    return;\n  }\n  const ul = document.getElementById('reviews-list');\n  reviews.forEach(review => {\n    ul.appendChild(createReviewHTML(review));\n  });\n  container.appendChild(ul);\n}\n\n/**\n * Create submit reviews HTML and add them to the webpage.\n */\nfillSubmitReviewsHTML = () => {\n  const container = document.getElementById('reviews-submit-container');\n  const title = document.createElement('h2');\n  title.innerHTML = 'Submit Review';\n  container.appendChild(title);\n\n\n  const username = document.createElement('input');\n  username.setAttribute('type', 'text');\n  username.setAttribute('name', 'username');\n  username.setAttribute('placeholder', 'username');\n  container.appendChild(username);\n\n  const rating = document.createElement('input');\n  rating.setAttribute('type', 'number');\n  rating.setAttribute('min', 0);\n  rating.setAttribute('max', 5);\n  rating.setAttribute('name', 'rating');\n  rating.setAttribute('placeholder', 'username');\n  container.appendChild(rating);\n\n  const restaurant_id = document.createElement('input');\n  restaurant_id.setAttribute('type', 'hidden');\n  restaurant_id.setAttribute('name', 'id');\n  restaurant_id.setAttribute('value', this.restaurant);\n  container.appendChild(restaurant_id);\n}\n\n/**\n * Create review HTML and add it to the webpage.\n */\ncreateReviewHTML = (review) => {\n  const li = document.createElement('li');\n  const name = document.createElement('p');\n  name.innerHTML = review.name;\n  li.appendChild(name);\n\n  const date = document.createElement('p');\n  date.innerHTML = review.date;\n  li.appendChild(date);\n\n  const rating = document.createElement('p');\n  rating.innerHTML = `Rating: ${review.rating}`;\n  li.appendChild(rating);\n\n  const comments = document.createElement('p');\n  comments.innerHTML = review.comments;\n  li.appendChild(comments);\n\n  return li;\n}\n\n/**\n * Add restaurant name to the breadcrumb navigation menu\n */\nfillBreadcrumb = (restaurant = this.restaurant) => {\n  const breadcrumb = document.getElementById('breadcrumb');\n  const li = document.createElement('li');\n  const a_link = document.createElement('a');\n  a_link.setAttribute('href', '#');\n  a_link.setAttribute('aria-current', 'page');\n  a_link.setAttribute('class', 'current-page')\n  a_link.innerHTML = restaurant.name;\n  li.appendChild(a_link);\n  breadcrumb.appendChild(li);\n}\n\n/**\n * Get a parameter by name from page URL.\n */\ngetParameterByName = (name, url) => {\n  if (!url)\n    url = window.location.href;\n  name = name.replace(/[\\[\\]]/g, '\\\\$&');\n  const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),\n    results = regex.exec(url);\n  if (!results)\n    return null;\n  if (!results[2])\n    return '';\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaWRiL2xpYi9pZGIuanMiLCJzcmMvanMvZGJoZWxwZXIuanMiLCJzcmMvanMvaW1hZ2VzLmpzIiwic3JjL2pzL3Jlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2VEEsTUFBTSxZQUFZLFFBQVEsVUFBUixDQUFsQjtBQUNBLE1BQU0sTUFBTSxR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QjtBQUNBLFNBQU8sWUFBUCxDQUFvQixjQUFwQixFQUFvQyxNQUFwQztBQUNBLFNBQU8sWUFBUCxDQUFvQixPQUFwQixFQUE2QixjQUE3QjtBQUNBLFNBQU8sU0FBUCxHQUFtQixXQUFXLElBQTlCO0FBQ0EsS0FBRyxXQUFILENBQWUsTUFBZjtBQUNBLGFBQVcsV0FBWCxDQUF1QixFQUF2QjtBQUNELENBVkQ7O0FBWUE7OztBQUdBLHFCQUFxQixDQUFDLElBQUQsRUFBTyxHQUFQLEtBQWU7QUFDbEMsTUFBSSxDQUFDLEdBQUwsRUFDRSxNQUFNLE9BQU8sUUFBUCxDQUFnQixJQUF0QjtBQUNGLFNBQU8sS0FBSyxPQUFMLENBQWEsU0FBYixFQUF3QixNQUF4QixDQUFQO0FBQ0EsUUFBTSxRQUFRLElBQUksTUFBSixDQUFZLE9BQU0sSUFBSyxtQkFBdkIsQ0FBZDtBQUFBLFFBQ0UsVUFBVSxNQUFNLElBQU4sQ0FBVyxHQUFYLENBRFo7QUFFQSxNQUFJLENBQUMsT0FBTCxFQUNFLE9BQU8sSUFBUDtBQUNGLE1BQUksQ0FBQyxRQUFRLENBQVIsQ0FBTCxFQUNFLE9BQU8sRUFBUDtBQUNGLFNBQU8sbUJBQW1CLFFBQVEsQ0FBUixFQUFXLE9BQVgsQ0FBbUIsS0FBbkIsRUFBMEIsR0FBMUIsQ0FBbkIsQ0FBUDtBQUNELENBWEQiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcmVxdWVzdDtcbiAgICB2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdCA9IG9ialttZXRob2RdLmFwcGx5KG9iaiwgYXJncyk7XG4gICAgICBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9KTtcblxuICAgIHAucmVxdWVzdCA9IHJlcXVlc3Q7XG4gICAgcmV0dXJuIHA7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpO1xuICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBwLnJlcXVlc3QpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3h5Q2xhc3MucHJvdG90eXBlLCBwcm9wLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgdGhpc1t0YXJnZXRQcm9wXVtwcm9wXSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0uYXBwbHkodGhpc1t0YXJnZXRQcm9wXSwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gSW5kZXgoaW5kZXgpIHtcbiAgICB0aGlzLl9pbmRleCA9IGluZGV4O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEluZGV4LCAnX2luZGV4JywgW1xuICAgICduYW1lJyxcbiAgICAna2V5UGF0aCcsXG4gICAgJ211bHRpRW50cnknLFxuICAgICd1bmlxdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdnZXQnLFxuICAgICdnZXRLZXknLFxuICAgICdnZXRBbGwnLFxuICAgICdnZXRBbGxLZXlzJyxcbiAgICAnY291bnQnXG4gIF0pO1xuXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdvcGVuQ3Vyc29yJyxcbiAgICAnb3BlbktleUN1cnNvcidcbiAgXSk7XG5cbiAgZnVuY3Rpb24gQ3Vyc29yKGN1cnNvciwgcmVxdWVzdCkge1xuICAgIHRoaXMuX2N1cnNvciA9IGN1cnNvcjtcbiAgICB0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgfVxuXG4gIHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xuICAgICdkaXJlY3Rpb24nLFxuICAgICdrZXknLFxuICAgICdwcmltYXJ5S2V5JyxcbiAgICAndmFsdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoQ3Vyc29yLCAnX2N1cnNvcicsIElEQkN1cnNvciwgW1xuICAgICd1cGRhdGUnLFxuICAgICdkZWxldGUnXG4gIF0pO1xuXG4gIC8vIHByb3h5ICduZXh0JyBtZXRob2RzXG4gIFsnYWR2YW5jZScsICdjb250aW51ZScsICdjb250aW51ZVByaW1hcnlLZXknXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICBpZiAoIShtZXRob2ROYW1lIGluIElEQkN1cnNvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgQ3Vyc29yLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGN1cnNvciA9IHRoaXM7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBjdXJzb3IuX2N1cnNvclttZXRob2ROYW1lXS5hcHBseShjdXJzb3IuX2N1cnNvciwgYXJncyk7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KGN1cnNvci5fcmVxdWVzdCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgY3Vyc29yLl9yZXF1ZXN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICBmdW5jdGlvbiBPYmplY3RTdG9yZShzdG9yZSkge1xuICAgIHRoaXMuX3N0b3JlID0gc3RvcmU7XG4gIH1cblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuY3JlYXRlSW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmNyZWF0ZUluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnaW5kZXhOYW1lcycsXG4gICAgJ2F1dG9JbmNyZW1lbnQnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdwdXQnLFxuICAgICdhZGQnLFxuICAgICdkZWxldGUnLFxuICAgICdjbGVhcicsXG4gICAgJ2dldCcsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdkZWxldGVJbmRleCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVHJhbnNhY3Rpb24oaWRiVHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xuICAgIHRoaXMuY29tcGxldGUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmFib3J0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLm9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl90eC5vYmplY3RTdG9yZS5hcHBseSh0aGlzLl90eCwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFRyYW5zYWN0aW9uLCAnX3R4JywgW1xuICAgICdvYmplY3RTdG9yZU5hbWVzJyxcbiAgICAnbW9kZSdcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKFRyYW5zYWN0aW9uLCAnX3R4JywgSURCVHJhbnNhY3Rpb24sIFtcbiAgICAnYWJvcnQnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIFVwZ3JhZGVEQihkYiwgb2xkVmVyc2lvbiwgdHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICAgIHRoaXMub2xkVmVyc2lvbiA9IG9sZFZlcnNpb247XG4gICAgdGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG4gIH1cblxuICBVcGdyYWRlREIucHJvdG90eXBlLmNyZWF0ZU9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl9kYi5jcmVhdGVPYmplY3RTdG9yZS5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFVwZ3JhZGVEQiwgJ19kYicsIFtcbiAgICAnbmFtZScsXG4gICAgJ3ZlcnNpb24nLFxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVXBncmFkZURCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnZGVsZXRlT2JqZWN0U3RvcmUnLFxuICAgICdjbG9zZSdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gREIoZGIpIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICB9XG5cbiAgREIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBUcmFuc2FjdGlvbih0aGlzLl9kYi50cmFuc2FjdGlvbi5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKERCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICAvLyBBZGQgY3Vyc29yIGl0ZXJhdG9yc1xuICAvLyBUT0RPOiByZW1vdmUgdGhpcyBvbmNlIGJyb3dzZXJzIGRvIHRoZSByaWdodCB0aGluZyB3aXRoIHByb21pc2VzXG4gIFsnb3BlbkN1cnNvcicsICdvcGVuS2V5Q3Vyc29yJ10uZm9yRWFjaChmdW5jdGlvbihmdW5jTmFtZSkge1xuICAgIFtPYmplY3RTdG9yZSwgSW5kZXhdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcbiAgICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIG5hdGl2ZU9iamVjdCA9IHRoaXMuX3N0b3JlIHx8IHRoaXMuX2luZGV4O1xuICAgICAgICB2YXIgcmVxdWVzdCA9IG5hdGl2ZU9iamVjdFtmdW5jTmFtZV0uYXBwbHkobmF0aXZlT2JqZWN0LCBhcmdzLnNsaWNlKDAsIC0xKSk7XG4gICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FsbGJhY2socmVxdWVzdC5yZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gcG9seWZpbGwgZ2V0QWxsXG4gIFtJbmRleCwgT2JqZWN0U3RvcmVdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcbiAgICBpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xuICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihxdWVyeSwgY291bnQpIHtcbiAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gICAgICB2YXIgaXRlbXMgPSBbXTtcblxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgaW5zdGFuY2UuaXRlcmF0ZUN1cnNvcihxdWVyeSwgZnVuY3Rpb24oY3Vyc29yKSB7XG4gICAgICAgICAgaWYgKCFjdXJzb3IpIHtcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XG5cbiAgICAgICAgICBpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICB2YXIgZXhwID0ge1xuICAgIG9wZW46IGZ1bmN0aW9uKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdvcGVuJywgW25hbWUsIHZlcnNpb25dKTtcbiAgICAgIHZhciByZXF1ZXN0ID0gcC5yZXF1ZXN0O1xuXG4gICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGlmICh1cGdyYWRlQ2FsbGJhY2spIHtcbiAgICAgICAgICB1cGdyYWRlQ2FsbGJhY2sobmV3IFVwZ3JhZGVEQihyZXF1ZXN0LnJlc3VsdCwgZXZlbnQub2xkVmVyc2lvbiwgcmVxdWVzdC50cmFuc2FjdGlvbikpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKGRiKSB7XG4gICAgICAgIHJldHVybiBuZXcgREIoZGIpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdkZWxldGVEYXRhYmFzZScsIFtuYW1lXSk7XG4gICAgfVxuICB9O1xuXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZXhwO1xuICAgIG1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcbiAgfVxuICBlbHNlIHtcbiAgICBzZWxmLmlkYiA9IGV4cDtcbiAgfVxufSgpKTtcbiIsImNvbnN0IEltYWdlSW5mbyA9IHJlcXVpcmUoJy4vaW1hZ2VzJyk7XHJcbmNvbnN0IGlkYiA9IHJlcXVpcmUoJ2lkYicpO1xyXG4vKipcclxuICogQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXHJcbiAqL1xyXG5jbGFzcyBEQkhlbHBlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIERhdGFiYXNlIFVSTC5cclxuICAgKiBDaGFuZ2UgdGhpcyB0byByZXN0YXVyYW50cy5qc29uIGZpbGUgbG9jYXRpb24gb24geW91ciBzZXJ2ZXIuXHJcbiAgICovXHJcbiAgc3RhdGljIGdldCBEQVRBQkFTRV9VUkwoKSB7XHJcbiAgICBjb25zdCBwb3J0ID0gJ0BAc2VydmVyX3BvcnQnIC8vIENoYW5nZSB0aGlzIHRvIHlvdXIgc2VydmVyIHBvcnRcclxuICAgIHJldHVybiBgaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9L3Jlc3RhdXJhbnRzYDtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBpbml0SW5kZXhlZERCKCkge1xyXG4gICAgdGhpcy5kYlByb21pc2UgPSBpZGIub3BlbigncmVzdGF1cmFudC1kYicsIDEsIGZ1bmN0aW9uICh1cGdyYWRlRGIpIHtcclxuICAgICAgc3dpdGNoICh1cGdyYWRlRGIub2xkVmVyc2lvbikge1xyXG4gICAgICAgIGNhc2UgMDpcclxuICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICBjb25zdCByZXN0YXVyYW50U3RvcmUgPSB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJywge1xyXG4gICAgICAgICAgICBrZXlQYXRoOiAnaWQnXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHJlc3RhdXJhbnRTdG9yZS5jcmVhdGVJbmRleCgncGhvdG9ncmFwaHMnLCAncGhvdG9ncmFwaCcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCByZXN0YXVyYW50cy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50cyhjYWxsYmFjaykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHNGcm9tU3RvcmFnZSgpLnRoZW4oKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnRzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgIHhoci5vcGVuKCdHRVQnLCBEQkhlbHBlci5EQVRBQkFTRV9VUkwpO1xyXG4gICAgeGhyLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgaWYgKHhoci5zdGF0dXMgPT09IDIwMCkgeyAvLyBHb3QgYSBzdWNjZXNzIHJlc3BvbnNlIGZyb20gc2VydmVyIVxyXG4gICAgICAgIGNvbnN0IHJlc3RhdXJhbnRzID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICBjb25zdCBpbWFnZURhdGEgPSBJbWFnZUluZm8uSW1hZ2VJbmZvRGF0YTtcclxuICAgICAgICByZXN0YXVyYW50cy5tYXAoZnVuY3Rpb24gKHJlc3RhdXJhbnQpIHtcclxuICAgICAgICAgIGlmIChyZXN0YXVyYW50LnBob3RvZ3JhcGgpIHtcclxuICAgICAgICAgICAgcmVzdGF1cmFudC5hbHQgPSBpbWFnZURhdGFbcmVzdGF1cmFudC5waG90b2dyYXBoXS5hbHQ7XHJcbiAgICAgICAgICAgIHJlc3RhdXJhbnQuY2FwdGlvbiA9IGltYWdlRGF0YVtyZXN0YXVyYW50LnBob3RvZ3JhcGhdLmNhcHRpb247XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBzZWxmLmRiUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChkYikge1xyXG4gICAgICAgICAgICB2YXIgdHggPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudHMnLCAncmVhZHdyaXRlJyk7XHJcbiAgICAgICAgICAgIHZhciByZXN0YXVyYW50U3RvcmUgPSB0eC5vYmplY3RTdG9yZSgncmVzdGF1cmFudHMnKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3RhdXJhbnRTdG9yZS5wdXQocmVzdGF1cmFudCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHJldHVybiByZXN0YXVyYW50O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnRzKTtcclxuICAgICAgfSBlbHNlIHsgLy8gT29wcyEuIEdvdCBhbiBlcnJvciBmcm9tIHNlcnZlci5cclxuICAgICAgICB0aGlzLmRiUHJvbWlzZS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHJldHVybiBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzRnJvbVN0b3JhZ2UoKVxyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3RhdXJhbnRzKSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50cyk7XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3IgPSAoYFJlcXVlc3QgZmFpbGVkLmApO1xyXG4gICAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHNGcm9tU3RvcmFnZSgpLnRoZW4oKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudHMpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHhoci5zZW5kKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBmcm9tIGluZGVjZWREQlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRzRnJvbVN0b3JhZ2UoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kYlByb21pc2UudGhlbihmdW5jdGlvbiAoZGIpIHtcclxuICAgICAgdmFyIHR4ID0gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJyk7XHJcbiAgICAgIHZhciByZXN0YXVyYW50c1N0b3JlID0gdHgub2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJyk7XHJcbiAgICAgIHJldHVybiByZXN0YXVyYW50c1N0b3JlLmdldEFsbCgpO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnQgYnkgSWQgZnJvbSBpbmRlY2VkREJcclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50RnJvbVN0b3JhZ2UoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLmRiUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChkYikge1xyXG4gICAgICB2YXIgdHggPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudHMnKTtcclxuICAgICAgdmFyIHJlc3RhdXJhbnRzU3RvcmUgPSB0eC5vYmplY3RTdG9yZSgncmVzdGF1cmFudHMnKTtcclxuICAgICAgcmV0dXJuIHJlc3RhdXJhbnRzU3RvcmUuZ2V0KHBhcnNlSW50KGlkKSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICB4aHIub3BlbignR0VUJywgREJIZWxwZXIuREFUQUJBU0VfVVJMICsgJy8nICsgaWQpO1xyXG4gICAgeGhyLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgaWYgKHhoci5zdGF0dXMgPT09IDIwMCkgeyAvLyBHb3QgYSBzdWNjZXNzIHJlc3BvbnNlIGZyb20gc2VydmVyIVxyXG4gICAgICAgIGNvbnN0IHJlc3RhdXJhbnQgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgIGlmIChyZXN0YXVyYW50LnBob3RvZ3JhcGgpIHtcclxuICAgICAgICAgIGNvbnN0IGltYWdlRGF0YSA9IEltYWdlSW5mby5JbWFnZUluZm9EYXRhO1xyXG4gICAgICAgICAgcmVzdGF1cmFudC5hbHQgPSBpbWFnZURhdGFbcmVzdGF1cmFudC5waG90b2dyYXBoXS5hbHQ7XHJcbiAgICAgICAgICByZXN0YXVyYW50LmNhcHRpb24gPSBpbWFnZURhdGFbcmVzdGF1cmFudC5waG90b2dyYXBoXS5jYXB0aW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLmRiUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChkYikge1xyXG4gICAgICAgICAgdmFyIHR4ID0gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJywgJ3JlYWR3cml0ZScpO1xyXG4gICAgICAgICAgdmFyIHJlc3RhdXJhbnRTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50cycpO1xyXG4gICAgICAgICAgcmV0dXJuIHJlc3RhdXJhbnRTdG9yZS5wdXQocmVzdGF1cmFudCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KTtcclxuICAgICAgfSBlbHNlIHsgLy8gT29wcyEuIEdvdCBhbiBlcnJvciBmcm9tIHNlcnZlci5cclxuICAgICAgICB0aGlzLmRiUHJvbWlzZS50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHJldHVybiBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRGcm9tU3RvcmFnZShpZClcclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KTtcclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBjb25zdCBlcnJvciA9IChgUmVxdWVzdCBmYWlsZWQuYCk7XHJcbiAgICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB4aHIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50RnJvbVN0b3JhZ2UoaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3RhdXJhbnQpIHtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICB4aHIuc2VuZCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIHR5cGUgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZShjdWlzaW5lLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzICB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZ1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIGN1aXNpbmUgdHlwZVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QobmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gbmVpZ2hib3Job29kXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsZXQgcmVzdWx0cyA9IHJlc3RhdXJhbnRzXHJcbiAgICAgICAgaWYgKGN1aXNpbmUgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IGN1aXNpbmVcclxuICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmVpZ2hib3Job29kICE9ICdhbGwnKSB7IC8vIGZpbHRlciBieSBuZWlnaGJvcmhvb2RcclxuICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaE5laWdoYm9yaG9vZHMoY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBHZXQgYWxsIG5laWdoYm9yaG9vZHMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2QpXHJcbiAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXHJcbiAgICAgICAgY29uc3QgdW5pcXVlTmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHMuZmlsdGVyKCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaSlcclxuICAgICAgICBjYWxsYmFjayhudWxsLCB1bmlxdWVOZWlnaGJvcmhvb2RzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoQ3Vpc2luZXMoY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBHZXQgYWxsIGN1aXNpbmVzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgY3Vpc2luZXMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLmN1aXNpbmVfdHlwZSlcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGN1aXNpbmVzXHJcbiAgICAgICAgY29uc3QgdW5pcXVlQ3Vpc2luZXMgPSBjdWlzaW5lcy5maWx0ZXIoKHYsIGkpID0+IGN1aXNpbmVzLmluZGV4T2YodikgPT0gaSlcclxuICAgICAgICBjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBwYWdlIFVSTC5cclxuICAgKi9cclxuICBzdGF0aWMgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTHMgSlNPTi5cclxuICAgKi9cclxuICBzdGF0aWMgaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIGNvbnN0IHJlcHJlc2VudGF0aW9uc1VSTHMgPSBEQkhlbHBlci5pbWFnZVJlcHJlc2VudGF0aW9uc1BhdGhzKHJlc3RhdXJhbnQucGhvdG9ncmFwaCk7XHJcbiAgICByZXR1cm4gcmVwcmVzZW50YXRpb25zVVJMcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhdGhzIGZvciB2YXJpb3VzIGltYWdlIHJlcHJlc2VudGF0aW9uc1xyXG4gICAqL1xyXG4gIHN0YXRpYyBpbWFnZVJlcHJlc2VudGF0aW9uc1BhdGhzKGZpbGVuYW1lKSB7XHJcbiAgICBjb25zdCBbZm9sZGVyTmFtZSwgc3VmZml4XSA9IFsnLi9pbWcvJywgJ2pwZyddIC8vLCd3ZWJwJ107XHJcbiAgICBjb25zdCBsYXJnZV8xeCA9IGZvbGRlck5hbWUuY29uY2F0KGZpbGVuYW1lLCAnLTUxMl8xeCcsICcuJywgc3VmZml4KTtcclxuICAgIGNvbnN0IGxhcmdlXzJ4ID0gZm9sZGVyTmFtZS5jb25jYXQoZmlsZW5hbWUsICctNTEyXzJ4JywgJy4nLCBzdWZmaXgpO1xyXG4gICAgY29uc3Qgc21hbGxfMXggPSBmb2xkZXJOYW1lLmNvbmNhdChmaWxlbmFtZSwgJy0zODBfMXgnLCAnLicsIHN1ZmZpeCk7XHJcbiAgICBjb25zdCBzbWFsbF8yeCA9IGZvbGRlck5hbWUuY29uY2F0KGZpbGVuYW1lLCAnLTM4MF8yeCcsICcuJywgc3VmZml4KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsYXJnZV8xeDogbGFyZ2VfMXgsXHJcbiAgICAgIGxhcmdlXzJ4OiBsYXJnZV8yeCxcclxuICAgICAgc21hbGxfMXg6IHNtYWxsXzF4LFxyXG4gICAgICBzbWFsbF8yeDogc21hbGxfMnhcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXHJcbiAgICovXHJcbiAgc3RhdGljIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XHJcbiAgICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcclxuICAgICAgcG9zaXRpb246IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICB0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxyXG4gICAgICB1cmw6IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCksXHJcbiAgICAgIG1hcDogbWFwLFxyXG4gICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBtYXJrZXI7XHJcbiAgfVxyXG5cclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IERCSGVscGVyOyIsIi8qKlxuICogQ29tbW9uIGltYWdlIGluZm8gY2xhc3NcbiAqL1xuY2xhc3MgSW1hZ2VJbmZvIHtcblxuICBzdGF0aWMgZ2V0IEltYWdlSW5mb0RhdGEoKSB7XG5cbiAgICByZXR1cm4ge1xuICAgICAgMToge1xuICAgICAgICBcImlkXCI6IDEsXG4gICAgICAgIFwicGhvdG9ncmFwaFwiOiBcIjFcIixcbiAgICAgICAgXCJhbHRcIjogXCJ0aGUgbWFpbiByZXN0YXVyYW50IGFyZWFcIixcbiAgICAgICAgXCJjYXB0aW9uXCI6IFwiTGFyZ2Ugc3BhY2Ugd2l0aCBuaWNlIGRlY29yYXRpb25cIlxuICAgICAgfSxcbiAgICAgIDI6IHtcbiAgICAgICAgXCJpZFwiOiAyLFxuICAgICAgICBcInBob3RvZ3JhcGhcIjogXCIyXCIsXG4gICAgICAgIFwiYWx0XCI6IFwicGl6emEgb24gYSBwbGF0ZVwiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJUYXN0eSBwaXp6YXMgbWFkZSBldmVyeSBkYXlcIlxuICAgICAgfSxcbiAgICAgIDM6IHtcbiAgICAgICAgXCJpZFwiOiAzLFxuICAgICAgICBcInBob3RvZ3JhcGhcIjogXCIzXCIsXG4gICAgICAgIFwiYWx0XCI6IFwidGhlIG1haW4gcmVzdGF1cmFudCBhcmVhIGVtcHR5XCIsXG4gICAgICAgIFwiY2FwdGlvblwiOiBcIk1vZGVybiBkZXNpZ24gdG8gZW5qb3kgeW91ciBtZWFsc1wiLFxuICAgICAgfSxcbiAgICAgIDQ6IHtcbiAgICAgICAgXCJpZFwiOiA0LFxuICAgICAgICBcInBob3RvZ3JhcGhcIjogXCI0XCIsXG4gICAgICAgIFwiYWx0XCI6IFwidGhlIGVudHJhbmNlIG9mIHRoZSBzaG9wXCIsXG4gICAgICAgIFwiY2FwdGlvblwiOiBcIlRoZSBjb3JuZXIgc2hvcCwgZWFzeSB0byBzcG90XCJcbiAgICAgIH0sXG4gICAgICA1OiB7XG4gICAgICAgIFwiaWRcIjogNSxcbiAgICAgICAgXCJwaG90b2dyYXBoXCI6IFwiNVwiLFxuICAgICAgICBcImFsdFwiOiBcImluc2lkZSB0aGUgc2hvcCwgY3VzdG9tZXJzIGFuZCBzdGFmZlwiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJNZWV0IG91ciBmcmllbmRseSBzdGFmZlwiXG4gICAgICB9LFxuICAgICAgNjoge1xuICAgICAgICBcImlkXCI6IDYsXG4gICAgICAgIFwicGhvdG9ncmFwaFwiOiBcIjZcIixcbiAgICAgICAgXCJhbHRcIjogXCJ0aGUgYXJlYSBpbnNpZGUgd2l0aCBzb21lIHBlb3BsZSBxdWV1ZWluZyBhbmQgb3RoZXIgZWF0aW5nXCIsXG4gICAgICAgIFwiY2FwdGlvblwiOiBcIkxhcmdlIHNwYWNlIGZvciBiaWcgZ3JvdXBzXCJcbiAgICAgIH0sXG4gICAgICA3OiB7XG4gICAgICAgIFwiaWRcIjogNyxcbiAgICAgICAgXCJwaG90b2dyYXBoXCI6IFwiN1wiLFxuICAgICAgICBcImFsdFwiOiBcImJsYWNrIGFuZCB3aGl0ZSwgdGhlIGRpc3BsYXkgb2YgdGhlIHNob3Agd2l0aCAyIHBlb3BsZSBwYXNzaW5nIGJ5XCIsXG4gICAgICAgIFwiY2FwdGlvblwiOiBcIk91ciBjbGFzc2ljIHNob3AsIHN0aWxsIGtlZXBpbmcgb3VyIHZhbHVlc1wiXG4gICAgICB9LFxuICAgICAgODoge1xuICAgICAgICBcImlkXCI6IDgsXG4gICAgICAgIFwicGhvdG9ncmFwaFwiOiBcIjhcIixcbiAgICAgICAgXCJhbHRcIjogXCJvdXRkb29yIGRpc3BsYXkgb2YgdGhlIGNvcm5lciBzaG9wLCBiaWcgbGFiZWwgcmVhZHMgJ3RoZSBEdXRjaCdcIixcbiAgICAgICAgXCJjYXB0aW9uXCI6IFwiRWFzeSB0byBmaW5kIG91ciBiZWF1dGlmdWwgYnVpbGRpbmdcIixcbiAgICAgIH0sXG4gICAgICA5OiB7XG4gICAgICAgIFwiaWRcIjogOSxcbiAgICAgICAgXCJwaG90b2dyYXBoXCI6IFwiOVwiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJFbmpveWluZyBvdXIgaG9tZSBtYWRlIG1lYWxzXCIsXG4gICAgICAgIFwiYWx0XCI6IFwiYmxhY2sgYW5kIHdoaXRlLCBwZW9wbGUgZWF0aW5nIGluIHRoZSByZXN0YXVyYW50XCJcbiAgICAgIH0sXG4gICAgICAxMDoge1xuICAgICAgICBcImlkXCI6IDEwLFxuICAgICAgICBcInBob3RvZ3JhcGhcIjogXCIxMFwiLFxuICAgICAgICBcImFsdFwiOiBcInRoZSBhcmVhIGluc2lkZSB0aGUgc2hvcCwgdGhlIGZ1cm5pdHVyZSBhbmQgYmFyLCB3aXRob3V0IHBlb3BsZVwiLFxuICAgICAgICBcImNhcHRpb25cIjogXCJNb2Rlcm4gc3BhY2UsIHJlYWR5IHRvIHNlcnZlIHlvdXIgYXBwZXRpdGVcIlxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEltYWdlSW5mbzsiLCJjb25zdCBEQkhlbHBlciA9IHJlcXVpcmUoJy4vZGJoZWxwZXInKTtcblxubGV0IHJlc3RhdXJhbnQ7XG52YXIgbWFwO1xuXG4vKipcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cbiAqL1xud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICBjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxuICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQodGhpcy5yZXN0YXVyYW50LCB0aGlzLm1hcCk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBJbml0aWFsaXNlIGluZGV4ZWREQlxuICovXG5EQkhlbHBlci5pbml0SW5kZXhlZERCKCk7XG5cblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbmZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcbiAgaWYgKHRoaXMucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcbiAgICBjYWxsYmFjayhudWxsLCB0aGlzLnJlc3RhdXJhbnQpXG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xuICBpZiAoIWlkKSB7IC8vIG5vIGlkIGZvdW5kIGluIFVSTFxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcbiAgfSBlbHNlIHtcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICAgIHRoaXMucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XG4gICAgICBpZiAoIXJlc3RhdXJhbnQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxuICovXG5maWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHRoaXMucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpO1xuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblxuICBpZiAocmVzdGF1cmFudC5waG90b2dyYXBoKSB7XG4gICAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpO1xuICAgIHBpY3R1cmUuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcbiAgICBwaWN0dXJlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5JywgXCJmaWdfXCIgKyByZXN0YXVyYW50LmlkKTtcbiAgICBwaWN0dXJlLnNldEF0dHJpYnV0ZSgncm9sZScsICdpbWcnKTtcblxuICAgIGNvbnN0IGltYWdlUmVwcmVzZW50YXRpb25zID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuICAgIGNvbnN0IHNvdXJjZVNtYWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG4gICAgc291cmNlU21hbGwuc2V0QXR0cmlidXRlKCdtZWRpYScsICcobWF4LXdpZHRoOjcwMHB4KScpXG4gICAgc291cmNlU21hbGwuc2V0QXR0cmlidXRlKCdzcmNzZXQnLFxuICAgICAgaW1hZ2VSZXByZXNlbnRhdGlvbnMuc21hbGxfMXhcbiAgICAgICAgLmNvbmNhdCgnIDF4LCcpXG4gICAgICAgIC5jb25jYXQoaW1hZ2VSZXByZXNlbnRhdGlvbnMuc21hbGxfMngpXG4gICAgICAgIC5jb25jYXQoJyAyeCcpXG4gICAgKTtcbiAgICBwaWN0dXJlLmFwcGVuZChzb3VyY2VTbWFsbCk7XG5cbiAgICBjb25zdCBzb3VyY2VMYXJnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuICAgIHNvdXJjZUxhcmdlLnNldEF0dHJpYnV0ZSgnbWVkaWEnLCAnKG1pbi13aWR0aDo3MDFweCknKVxuICAgIHNvdXJjZUxhcmdlLnNldEF0dHJpYnV0ZSgnc3Jjc2V0JyxcbiAgICAgIGltYWdlUmVwcmVzZW50YXRpb25zLmxhcmdlXzF4XG4gICAgICAgIC5jb25jYXQoJyAxeCwnKVxuICAgICAgICAuY29uY2F0KGltYWdlUmVwcmVzZW50YXRpb25zLmxhcmdlXzJ4KVxuICAgICAgICAuY29uY2F0KCcgMngnKVxuICAgICk7XG4gICAgcGljdHVyZS5hcHBlbmQoc291cmNlTGFyZ2UpO1xuXG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICBpbWFnZS5zcmMgPSBpbWFnZVJlcHJlc2VudGF0aW9ucy5zbWFsbF8yeDtcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsICdyZXN0YXVyYW50ICcuY29uY2F0KHJlc3RhdXJhbnQubmFtZSwgJywgJywgcmVzdGF1cmFudC5hbHQpKTtcbiAgICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xuICAgIHBpY3R1cmUuYXBwZW5kKGltYWdlKTtcblxuICAgIGNvbnN0IGZpZ2NhcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmaWdjYXB0aW9uJyk7XG4gICAgZmlnY2FwdGlvbi5zZXRBdHRyaWJ1dGUoJ2lkJywgXCJmaWdfXCIgKyByZXN0YXVyYW50LmlkKVxuICAgIGZpZ2NhcHRpb24uaW5uZXJIVE1MID0gcmVzdGF1cmFudC5jYXB0aW9uO1xuICAgIHBpY3R1cmUuYXBwZW5kKGZpZ2NhcHRpb24pO1xuICB9XG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuICB9XG4gIC8vIGZpbGwgcmV2aWV3c1xuICBmaWxsUmV2aWV3c0hUTUwoKTtcbiAgZmlsbFN1Ym1pdFJldmlld3NIVE1MKCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSB0aGlzLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKTtcbiAgZm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcblxuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgZGF5LmlubmVySFRNTCA9IGtleTtcbiAgICByb3cuYXBwZW5kQ2hpbGQoZGF5KTtcblxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XTtcbiAgICByb3cuYXBwZW5kQ2hpbGQodGltZSk7XG5cbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxuICovXG5maWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHRoaXMucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcblxuICBpZiAoIXJldmlld3MpIHtcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcbiAgfSk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHN1Ym1pdCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxuICovXG5maWxsU3VibWl0UmV2aWV3c0hUTUwgPSAoKSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLXN1Ym1pdC1jb250YWluZXInKTtcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuICB0aXRsZS5pbm5lckhUTUwgPSAnU3VibWl0IFJldmlldyc7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cblxuICBjb25zdCB1c2VybmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gIHVzZXJuYW1lLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0Jyk7XG4gIHVzZXJuYW1lLnNldEF0dHJpYnV0ZSgnbmFtZScsICd1c2VybmFtZScpO1xuICB1c2VybmFtZS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJywgJ3VzZXJuYW1lJyk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1c2VybmFtZSk7XG5cbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgcmF0aW5nLnNldEF0dHJpYnV0ZSgndHlwZScsICdudW1iZXInKTtcbiAgcmF0aW5nLnNldEF0dHJpYnV0ZSgnbWluJywgMCk7XG4gIHJhdGluZy5zZXRBdHRyaWJ1dGUoJ21heCcsIDUpO1xuICByYXRpbmcuc2V0QXR0cmlidXRlKCduYW1lJywgJ3JhdGluZycpO1xuICByYXRpbmcuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICd1c2VybmFtZScpO1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICBjb25zdCByZXN0YXVyYW50X2lkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgcmVzdGF1cmFudF9pZC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnaGlkZGVuJyk7XG4gIHJlc3RhdXJhbnRfaWQuc2V0QXR0cmlidXRlKCduYW1lJywgJ2lkJyk7XG4gIHJlc3RhdXJhbnRfaWQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHRoaXMucmVzdGF1cmFudCk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZChyZXN0YXVyYW50X2lkKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBkYXRlLmlubmVySFRNTCA9IHJldmlldy5kYXRlO1xuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcblxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XG5cbiAgcmV0dXJuIGxpO1xufVxuXG4vKipcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XG4gKi9cbmZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQgPSB0aGlzLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgY29uc3QgYV9saW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICBhX2xpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgJyMnKTtcbiAgYV9saW5rLnNldEF0dHJpYnV0ZSgnYXJpYS1jdXJyZW50JywgJ3BhZ2UnKTtcbiAgYV9saW5rLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnY3VycmVudC1wYWdlJylcbiAgYV9saW5rLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcbiAgbGkuYXBwZW5kQ2hpbGQoYV9saW5rKTtcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XG59XG5cbi8qKlxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xuICBpZiAoIXVybClcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICBpZiAoIXJlc3VsdHMpXG4gICAgcmV0dXJuIG51bGw7XG4gIGlmICghcmVzdWx0c1syXSlcbiAgICByZXR1cm4gJyc7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XG59Il19"}